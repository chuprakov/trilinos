#!/bin/bash

TEST_SRC="test_main.c test_c_dnax.c test_c_tpi.c test_pthreads.c"

LIB_SRC="../src/TPI_pthreads.c ../src/TPI_Walltime.c ../src/TPI_Concurrency.c"

LIB_OBJ="TPI_pthreads.o TPI_Walltime.o TPI_Concurrency.o"

#-----------------------------------------------------------------------

gcc	-O3 -c	\
	-I../include ${LIB_SRC}
	
gcc	-O3	\
	-o test_tpi.gnu_plain.exe	\
	-I../include ${TEST_SRC} ${LIB_OBJ} -lpthread
	
g++	-O3	\
	-o test_tpi_cpp.gnu_plain.exe	\
	-I../include test_tpi.cpp ${LIB_OBJ} -lpthread

gcc	-O3	\
	-o test_sum.gnu_plain.exe	\
	-I../include test_mpi_sum.c ${LIB_OBJ} -lpthread
	
#-----------------------------------------------------------------------

GNU_PATH="/usr/local/gcc/32Bit/4.0.1/bin"

export PATH="${GNU_PATH}:${PATH}"

gcc	-std=c99 -Wall -Wextra -Werror	\
	-Wa,--32 -m32 -static	\
	-O3 -c	\
	-I../include ${LIB_SRC}

gcc	-std=c99 -Wall -Wextra -Werror	\
	-Wa,--32 -m32 -static	\
	-O3	\
	-o test_tpi.gnu_4_c99.exe	\
	-I../include ${TEST_SRC} ${LIB_OBJ} -lpthread

g++	-std=c++98 -Wall -Wextra -Werror	\
	-Wa,--32 -m32 -static	\
	-O3	\
	-o test_tpi.gnu_4_c++98.exe	\
	-I../include test_tpi.cpp ${LIB_OBJ} -lpthread

gcc	-std=c99 -Wall -Wextra -Werror	\
	-Wa,--32 -m32 -static	\
	-O3	\
	-o test_sum.gnu_4_c99.exe	\
	-I../include test_mpi_sum.c ${LIB_OBJ} -lpthread
	
#-----------------------------------------------------------------------

GNU_PATH="/usr/local/gcc/32Bit/3.4.3/bin"
MPI_PATH="/usr/local/mpi/sierra/32Bit/1.2.7/gcc-3.4.3"

export PATH="${MPI_PATH}/bin:${GNU_PATH}:${PATH}"

gcc	-std=c99 -Wall -Wextra -Werror	\
	-Wa,--32 -m32 -static	\
	-O3 -c	\
	-I../include ${LIB_SRC}

mpicc	-std=c99 -Wall -Wextra -Werror  \
	-Wa,--32 -m32 -static	\
	-O3	\
	-o test_sum.mpi.gnu_3_4_c99.exe	\
	-I../include -DTEST_WITH_MPI test_mpi_sum.c ${LIB_OBJ} -lpthread
	

