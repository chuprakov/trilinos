INCLUDE(TribitsLibraryMacros)
INCLUDE(TribitsAddOptionAndDefine)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})

#----------------------------------------------------------------------------
# set nvcc behavior
#
# SET(CUDA_ATTACH_VS_BUILD_RULE_TO_CUDA_FILE OFF)

SET(CUDA_ATTACH_VS_BUILD_RULE_TO_CUDA_FILE OFF CACHE BOOL
    "" FORCE )
SET(CUDA_PROPAGATE_HOST_FLAGS              OFF CACHE BOOL
    "" FORCE )

#----------------------------------------------------------------------------

SET(HEADERS "")
SET(SOURCES "")
SET(CUDA_SOURCES "")

FILE(GLOB HEADERS *.hpp)
FILE(GLOB CUDA_SOURCES *.cu)

CUDA_COMPILE(CUDA_OBJECTS ${CUDA_SOURCES})

SET(SOURCES ${SOURCES} ${CUDA_OBJECTS})

TRIBITS_ADD_LIBRARY(
  kokkoscore_devicecuda
  NOINSTALLHEADERS ${HEADERS}
  SOURCES ${SOURCES}
  DEPLIBS kokkoscore_impl
  CUDALIBRARY
)

SET(TRILINOS_INCDIR ${CMAKE_INSTALL_PREFIX}/${Trilinos_INSTALL_INCLUDE_DIR})

INSTALL(FILES ${HEADERS} DESTINATION ${TRILINOS_INCDIR}/Cuda/)


