% @HEADER
% ***********************************************************************
%
%                      Didasko Tutorial Package
%                 Copyright (2005) Sandia Corporation
%
% Under terms of Contract DE-AC04-94AL85000, there is a non-exclusive
% license for use of this work by or on behalf of the U.S. Government.
%
% This library is free software; you can redistribute it and/or modify
% it under the terms of the GNU Lesser General Public License as
% published by the Free Software Foundation; either version 2.1 of the
% License, or (at your option) any later version.
%
% This library is distributed in the hope that it will be useful, but
% WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
% Lesser General Public License for more details.
%
% You should have received a copy of the GNU Lesser General Public
% License along with this library; if not, write to the Free Software
% Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
% USA
% Questions? Contact Michael A. Heroux (maherou@sandia.gov)
%
% ***********************************************************************
% @HEADER

\chapter{Introduction}

\ChapterAuthors{Marzio Sala, Michael Heroux, David Day}
%%%
%%%
%%%

\section{Getting Started}
\label{sec:getting}

The Trilinos framework uses a two level software structure that connects
a system of {\sl packages}. A Trilinos package is an integral unit,
usually developed to solve a specific task, by a (relatively) small
group of experts.  Packages exist beneath the Trilinos top level,
which provides a common look-and-feel. Each package has its own
structure, documentation and set of examples, and it is possibly
available independently of Trilinos. However, each package is even more
valuable when combined with other Trilinos packages.

\smallskip

Trilinos is a large software project, and currently about thirty
packages are included.  The entire set of packages covers a wide range
of numerical methods for large scale computing, as well as a large set
of utilities to improve the development of software for scientific
computing.

Clearly, a full understanding all the functionalities of the Trilinos
packages requires time.  Each package offers sophisticated features,
difficult to ``unleash'' at a first sight.  Besides that, a detailed
description of each Trilinos package is beyond the scope of this
document. For these reasons, the goal of this tutorial is to ensure that
users have the background to make good use of the extensive
documentation contained in each package.
%For a
%successive fine-tuning phase, users still must look through individual
%package's documentation and examples.

\medskip

We will describe the following subset of the Trilinos packages.
\begin{itemize}
\item {\bf Epetra}. The package defines the basic classes for
  distributed matrices and vectors, linear operators and linear
  problems. Epetra classes are the common language spoken by all the
  Trilinos packages (even if some packages can ``speak'' other
  languages). Each Trilinos package accepts as input Epetra objects.
  This allows powerful combinations among the various Trilinos
  functionalities.
\item {\bf Triutils}. This is a collection of utilities that are useful
  in software development. Here, we present a command line parser and a
  matrix generator, that are used throughout this document to define
  example matrices.
\item {\bf AztecOO}. This is a linear solver package based on
  preconditioned Krylov methods. Aztec users will find that AztecOO
  supports all the Aztec interfaces and functionality, and also provides
  significant new functionality.
\item {\bf IFPACK}. The package performs various incomplete
  factorizations, and is here used with AztecOO.
\item {\bf Teuchos}. This is a collection of classes that can be
  essential for advanced code development.
\item {\bf ML}. The algebraic multilevel and domain decomposition
  preconditioner package provides scalable preconditioning capabilities
  for a variety of problems. It is here used as a preconditioner
  for AztecOO solvers.
\item {\bf Amesos}. The package provides a common interface to certain
  sparse direct linear solvers (generally available outside the Trilinos
  framework), both sequential and parallel.
\item {\bf Anasazi}. The package provides a common interface to parallel eigenvalue
  and eigenvector solvers, for both symmetric and non-symmetric linear problems.
\item {\bf NOX}. This is a collection of nonlinear solvers, designed to
  be easily integrated into an application and used with many different
  linear solvers.
\item {\bf Didasko}. This package contains all the examples reported in this
tutorial. The sources of the examples can be found in the subdirectory\\
\verb!<your-trilinos-home>/packages/didasko/examples!.
\end{itemize}

Table~\ref{tab:tripackages} gives a partial overview of what can be
accomplished using Trilinos.
\begin{table}[htbp]
  \centering
  \begin{tabular}{| p{8cm} | p{2.5cm} | p{3cm} |}
    \hline
    {\bf Service provided/Task performed} & {\bf Package} & {\bf Tutorial}\\
    \hline
    \hline
    Advanced serial dense or sparse matrices: & Epetra
    & Chapter \ref{chap:epetra_mat} \\
    Advanced utilities for Epetra vectors and sparse matrices: &
    EpetraExt & --
    \\
    \hline
    Templated distributed vectors and sparse matrices: & Tpetra$^\star$
    & -- \\
    \hline
    Distributed sparse matrices:& Epetra & -- \\
    \hline
    Solve a linear system with preconditioned Krylov accelerators,
    CG, GMRES, Bi-CGSTAB, TFQMR:& AztecOO, Belos$^\star$ &
    Chapter \ref{chap:aztecoo} \\
    \hline
    Incomplete Factorizations:& AztecOO, \newline IFPACK &
    Chapter \ref{chap:ifpack} \\
    \hline
    Multilevel  preconditioners: & ML & Chapter \ref{chap:ml} \\
    \hline
    ``Black-box'' smoothed aggregation preconditioners:& ML & Section
    \ref{sec:ml:preconditioner} \\
    \hline
    One-level Schwarz preconditioner (overlapping domain
    decomposition):& AztecOO, \newline IFPACK & Chapter
    \ref{chap:ifpack} \\
    \hline
    Two-level Schwarz preconditioner, with coarse matrix based on
    aggregation:& AztecOO+ML & Section \ref{sec:ml_DD} \\
    \hline
    Systems of nonlinear equations:& NOX & Chapter \ref{chap:nox} \\
    \hline
    Interface with various direct solvers, as UMFPACK, MUMPS, SuperLU\_DIST
    and ScaLAPACK :& Amesos & Chapter \ref{chap:amesos} \\
    \hline
    Eigenvalue problems for sparse matrices:& Anasazi & Chapter
    \ref{chap:anasazi} \\
    \hline
    Complex linear systems (using equivalent real formulation):&
    Komplex$^\star$ & -- \\
    \hline
    Segregated and block preconditioners (e.g., incompressible
    Navier-Stokes equations):&
    Meros$^\star$ & -- \\
    \hline
    Light-weight interface to BLAS and LAPACK: & Epetra
    & Chapter \ref{chap:epetra_mat} \\
    \hline
    Templated interface to BLAS and LAPACK, arbitrary-precision
    arithmetic, parameters' list, smart pointers:& Teuchos &
    Section \ref{sec:teuchos:LAPACK} \\
    \hline
    Definition of abstract interfaces to vectors, linear operators, and
    solvers:& TSF$^\star$, TSFCore$^\star$, TSFExtended$^\star$   & --
    \\
    \hline
    Generation of test matrices & Triutils & Section~\ref{sec:triutils:gallery} \\
    \hline
  \end{tabular}
  \caption{Partial overview of intended uses of  Trilinos. $\star$:
    not covered in this tutorial.}
  \label{tab:tripackages}
\end{table}

\begin{remark}
  As already pointed out, Epetra objects are meant to be the ``common
  language'' spoken by all the Trilinos packages, and are a natural
  starting point. For new users, Chapters
  \ref{chap:epetra_vec}-\ref{chap:epetra_others} are a prerequisite to
  the later chapters. Chapters~\ref{chap:triutils} is not essential to
  understand Trilinos, but the functionalities there presented are used
  in this document as a starting point for many examples.  One of the
  classes described in Chapter~\ref{chap:teuchos}, the
  Teuchos::ParameterList, is later used in Chapters~\ref{chap:ml} and
  \ref{chap:amesos}.  Chapter~\ref{chap:aztecoo} should be read before
  Chapters~\ref{chap:ifpack} and~\ref{chap:ml} (even if both IFPACK and
  ML can be compiled and run without AztecOO).
\end{remark}

The only prerequisites assumed in this tutorial are some familiarities
with numerical methods for PDEs, and with iterative linear and nonlinear
solvers. Although not strictly necessary, the reader is assumed to have
some familiarity with distributed memory computing and, to a lesser
extent, with MPI\footnote{Although almost no explicit MPI instructions
  are required in a Trilinos code, the reader should be aware of the
  basic concepts of message passing, like the definition of a
  communicator.}.

\smallskip

Note that this tutorial is not a substitute for individual packages'
documentation. Also, for an overview of all the Trilinos packages, the
Trilinos philosophy, and a description of the packages provided by
Trilinos, the reader is referred to \cite{Trilinos-Overview}.
Developers should also consider the Trilinos Developers' Guide, which
addresses many topics, including the development tools used by Trilinos'
developers, and a description of how to include a new package\footnote{
  Trilinos provides a variety of services to a developer wanting to
  integrate a package into Trilinos.  The services include
  Autoconf~\cite{Autoconf}, Automake~\cite{Automake} and
  Libtool~\cite{Libtool}. The tools provide a robust, full-featured set
  of tools for building software across a broad set of platforms.  The
  tools are not officially standards, but are widely used.  All existing
  Trilinos packages use Autoconf and Automake.  Libtool support will be
  added in future releases.}.

%%%
%%%
%%%

\section{Installation}
\label{sec:installing}

To obtain Trilinos, please follow the instructions at the web site
\begin{verbatim}
http://trilinos.sandia.gov
\end{verbatim}

Trilinos has been compiled on a variety of architectures, including
various flavors of Linux, Sun Solaris, SGI Irix, DEC, Mac OSX, IBM
AIX, ASC Red Storm, and others. Trilinos has been designed to support parallel
applications.  However, it also compiles and runs on serial computers.
An introduction to Trilinos and a list of FAQs
may be found at the web pages:
\begin{verbatim}
http://trilinos.sandia.gov/getting_started.html
http://trilinos.sandia.gov/faq.html
\end{verbatim}

After obtaining Trilinos, the next step is its compilation. The
description here is for LINUX platforms with MPI, the compilation on
other platforms being pretty similar.

Each Trilinos' package can be enabled or disabled at configuration time.
A procedure one may follow in order to compile Trilinos with AztecOO,
ML, IFPACK, Anasazi, NOX, Triutils, and Didasko (which contains the examples
used in this tutorial) is reported below. \$ indicates the
shell prompt. The \verb!tee! command is used to write the output to
standard output and to the specified file, and may be omitted.  More
details about the installation of Trilinos can be found in
\cite{Trilinos-Users-Guide}.
\begin{verbatim}
$ cd <your-trilinos-directory>
$ mkdir LINUX_MPI
$ cd LINUX_MPI
$ ../configure --prefix=<your-trilinos-directory>/LINUX_MPI \
  --enable-mpi --with-mpi-compilers \
  --disable-default-packages        \
  --enable-teuchos    \
  --enable-epetra     \
  --enable-aztecoo    \
  --enable-triutils   \
  --enable-amesos     \
  --enable-ifpack     \
  --enable-ml         \
  --enable-nox        \
  --enable-nox-epetra \
  --enable-didasko    | tee configure_LINUX_MPI.log
$ make everything| tee make_LINUX_MPI.log
$ make install | tee make_install_LINUX_MPI.log
\end{verbatim}
For more details, simply type
\begin{verbatim}
$ <your-trilinos-directory>/configure --help
\end{verbatim}
For serial configuration, simply
delete the \verb!--enable-mpi --with-mpi-compilers! options
(and possibly change the name of the installation directory from
 {\tt LINUX\_MPI} to something like {\tt LINUX\_SERIAL}).

\begin{remark}
  All Trilinos packages can be build to run with or without MPI. If MPI
  is enabled (using \verb!--enable-mpi!), the users must know the
  procedure for beginning MPI jobs on their computer system(s). It may be
  necessary to specify on the configure line the location of MPI include
  files and libraries.
\end{remark}

\begin{remark}
  Compiling Trilinos may require a little bit of time! For instance, on a Pentium 4, 1.7
  GHz with Intel compilers, to configure Trilinos with LOCA, NOX,
  AztecOO, Anasazi, IFPACK, Triutils, EpetraExt, Teuchos, ML and Epetra,
  required 2 minutes and 11 seconds. The compilation (without the
  examples) took 5 minutes and 41 seconds. The reader might find convenient to
  start by enabling a limited number of packages, then re-configuring
  Trilinos as required.
\end{remark}

%%%
%%%
%%%

\section{Copyright and Licensing of Trilinos}
\label{sec:copyright}

Trilinos is released under the Lesser GPL GNU Licence.

Trilinos is copyrighted by Sandia Corporation. Under the terms of
Contract DE-AC04-94AL85000, there is a non-exclusive license for use of
this work by or on behalf of the U.S. Government.  Export of this
program may require a license from the United States Government.

NOTICE: The United States Government is granted for itself and others
acting on its behalf a paid-up, nonexclusive, irrevocable worldwide
license in ths data to reproduce, prepare derivative works, and perform
publicly and display publicly.  Beginning five (5) years from July 25,
2001, the United States Government is granted for itself and others
acting on its behalf a paid-up, nonexclusive, irrevocable worldwide
license in this data to reproduce, prepare derivative works, distribute
copies to the public, perform publicly and display publicly, and to
permit others to do so.

NEITHER THE UNITED STATES GOVERNMENT, NOR THE UNITED STATES DEPARTMENT
OF ENERGY, NOR SANDIA CORPORATION, NOR ANY OF THEIR EMPLOYEES, MAKES ANY
WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES ANY LEGAL LIABILITY OR
RESPONSIBILITY FOR THE ACCURACY, COMPLETENESS, OR USEFULNESS OF ANY
INFORMATION, APPARATUS, PRODUCT, OR PROCESS DISCLOSED, OR REPRESENTS
THAT ITS USE WOULD NOT INFRINGE PRIVATELY OWNED RIGHTS.

\medskip

Some parts of Trilinos are dependent on a third party code. Each third
party code comes with its own copyright and/or licensing requirements.
It is responsibility of the user to understand these requirements.

%%%
%%%
%%%

\section{Programming Language Used in this Tutorial}
\label{sec:language}

Trilinos is written in C++ (for most packages), and in C. Some
interfaces are provided to FORTRAN codes (mainly BLAS and LAPACK
routines). Even if limited support is included for C programs (and a
more limited for FORTRAN code), to unleash the full power of Trilinos we
recommend C++. All the example programs contained in this tutorial are
in C++; some packages (like ML) contain examples in C.

%%%
%%%
%%%

\section{Referencing Trilinos}
\label{sec:referencing}

The Trilinos project can be referenced by using the following BiBTeX
citation information:
\begin{verbatim}
@techreport{Trilinos-Overview,
title = "{An Overview of Trilinos}",
author = "Michael Heroux and Roscoe Bartlett and Vicki Howle
Robert Hoekstra and Jonathan Hu and Tamara Kolda and
Richard Lehoucq and Kevin Long and Roger Pawlowski and
Eric Phipps and Andrew Salinger and Heidi Thornquist and
Ray Tuminaro and James Willenbring and Alan Williams ",
institution = "Sandia National Laboratories",
number = "SAND2003-2927",
year = 2003}

@techreport{Trilinos-Dev-Guide,
title = "{Trilinos Developers Guide}",
author = "Michael A. Heroux and James M. Willenbring and Robert Heaphy",
institution = "Sandia National Laboratories",
number = "SAND2003-1898",
year = 2003}

@techreport{Trilinos-Dev-Guide-II,
title = "{Trilinos Developers Guide Part II: ASCI Software Quality
Engineering Practices Version 1.0}",
author = "Michael A. Heroux and James M. Willenbring and Robert Heaphy",
institution = "Sandia National Laboratories",
number = "SAND2003-1899",
year = 2003}

@techreport{Trilinos-Users-Guide,
title = "{Trilinos Users Guide}",
author = "Michael A. Heroux and James M. Willenbring",
institution = "Sandia National Laboratories",
number = "SAND2003-2952",
year = 2003}

@techreport{Trilinos-Tutorial-5.0,
title = "{Trilinos Tutorial}",
author = "Marzio Sala and Michael A. Heroux and David M. Day",
institution = "Sandia National Laboratories",
number = "SAND2004-2189",
year = 2004}
\end{verbatim}
The BiBTeX information is available at the web page
\begin{verbatim}
http://trilinos.sandia.gov/citing.html
\end{verbatim}

%%%
%%%
%%%

\section{A Note on the Directory Structure}
\label{sec:into_note}

Each Trilinos package in contained in the subdirectory
\begin{verbatim}
<your-trilinos-directory>/packages
\end{verbatim}
Each package contains sources, examples, tests and documentation subdirectories:
\begin{verbatim}
<your-trilinos-directory>/packages/<package-name>/src
<your-trilinos-directory>/packages/<package-name>/examples
<your-trilinos-directory>/packages/<package-name>/test
<your-trilinos-directory>/packages/<package-name>/doc
\end{verbatim}
Developers' documentation is written using Doxygen\footnote{Copyright
  \copyright 1997-2003 by Dimitri van Heesch. More information can by
  found at the web address {\tt
    http://www.stack.nl/~dimitri/doxygen/}.}. For instance, to create
the documentation for Epetra are
\begin{verbatim}
$ cd <your-trilinos-home>/packages/epetra/doc
$ doxygen
\end{verbatim}
Generally, both HTML and \LaTeX~documentation are created by Doxygen.
The browser of choice can be used to walk through the HTML
documentation.  To compile the \LaTeX~sources, the commands are:
\begin{verbatim}
$ cd <your-trilinos-home>/packages/epetra/doc/latex
$ make
\end{verbatim}

%%%
%%%
%%%

\section{List of Trilinos Developers}
\label{sec:intro_incomplete}

Below is a list of past and present Trilinos developers as of 
July 2007 (alphabetical order):

Christopher Baker,
Roscoe A. Bartlett,
Paul Boggs,
Erik Boman,
Todd Coffey,
Jason A. Cross,
David M. Day,
Clark Dohrmann,
David Gay,
Michael Gee,
Robert Heaphy,
Ulrich Hetmaniuk,
Michael A. Heroux (project leader),
Robert J. Hoekstra,
Russell Hooper,
Vicki E. Howle,
Jonathan J. Hu,
Tamara G. Kolda,
Kristopher Kampshoff,
Sarah Knepper,
Joe Kotulski,
Richard B. Lehoucq,
Paul Lin,
Kevin R. Long,
Joe Outzen,
Roger P. Pawlowski,
Michael N. Phenow,
Eric T. Phipps,
Andrew J. Rothfuss,
Marzio Sala,
Andrew G. Salinger,
Paul M. Sexton,
Chris Siefert,
Kendall S. Stanley,
Heidi K. Thornquist,
Ray S. Tuminaro,
James M. Willenbring, and
Alan Williams.

