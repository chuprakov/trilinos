#ifndef INTREPID_F1_TET_I2_FEM_FIAT_HPP
#define INTREPID_F1_TET_I2_FEM_FIAT_HPP
#include "Intrepid_Basis.hpp"
#include "Intrepid_RealSpace.hpp"
#include "Intrepid_Utils.hpp"
#include "Intrepid_Tabulate.hpp"
#include "Intrepid_FieldContainer.hpp"
#include "Teuchos_Array.hpp"
#include "Teuchos_BLAS_types.hpp"

namespace Intrepid {

/** \class Intrepid::Basis_F1_TET_I2_FEM_FIAT
  \brief Implementation of FIAT FEM basis functions of degree 2 for 1-forms on TET cells. 
  Reconstruction space type is INCOMPLETE. Definition of the DoF set 
  for this basis, its enumeration and the associated local DoF tags are as follows,

\verbatim
  =================================================================================================
  |        |                degree-of-freedom-tag              |                                  |
  | DoF Id |---------------------------------------------------|          DoF definition          |
  |        |  subc dim  |  subc id   | subc DoFId |subc num DoF|                                  |
  |========|============|============|============|============|==================================|
  |    0   |     1      |     0      |     0      |     2      |L_0(u)=(u.t)(0.333333333333,0.0,0.0)  |
  |========|============|============|============|============|==================================|
  |    1   |     1      |     0      |     1      |     2      |L_1(u)=(u.t)(0.666666666667,0.0,0.0)  |
  |========|============|============|============|============|==================================|
  |    2   |     1      |     1      |     0      |     2      |L_2(u)=(u.t)(0.666666666667,0.333333333333,0.0)  |
  |========|============|============|============|============|==================================|
  |    3   |     1      |     1      |     1      |     2      |L_3(u)=(u.t)(0.333333333333,0.666666666667,0.0)  |
  |========|============|============|============|============|==================================|
  |    4   |     1      |     2      |     0      |     2      |L_4(u)=(u.t)(0.0,0.666666666667,0.0)  |
  |========|============|============|============|============|==================================|
  |    5   |     1      |     2      |     1      |     2      |L_5(u)=(u.t)(0.0,0.333333333333,0.0)  |
  |========|============|============|============|============|==================================|
  |    6   |     1      |     3      |     0      |     2      |L_6(u)=(u.t)(0.0,0.0,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |    7   |     1      |     3      |     1      |     2      |L_7(u)=(u.t)(0.0,0.0,0.666666666667)  |
  |========|============|============|============|============|==================================|
  |    8   |     1      |     4      |     0      |     2      |L_8(u)=(u.t)(0.666666666667,0.0,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |    9   |     1      |     4      |     1      |     2      |L_9(u)=(u.t)(0.333333333333,0.0,0.666666666667)  |
  |========|============|============|============|============|==================================|
  |   10   |     1      |     5      |     0      |     2      |L_10(u)=(u.t)(0.0,0.666666666667,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   11   |     1      |     5      |     1      |     2      |L_11(u)=(u.t)(0.0,0.333333333333,0.666666666667)  |
  |========|============|============|============|============|==================================|
  |   12   |     2      |     0      |     0      |     2      |L_12(u)=(u.t0)(0.333333333333,0.0,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   13   |     2      |     0      |     1      |     2      |L_13(u)=(u.t1)(0.333333333333,0.0,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   14   |     2      |     1      |     0      |     2      |L_14(u)=(u.t0)(0.333333333333,0.333333333333,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   15   |     2      |     1      |     1      |     2      |L_15(u)=(u.t1)(0.333333333333,0.333333333333,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   16   |     2      |     2      |     0      |     2      |L_16(u)=(u.t0)(0.0,0.333333333333,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   17   |     2      |     2      |     1      |     2      |L_17(u)=(u.t1)(0.0,0.333333333333,0.333333333333)  |
  |========|============|============|============|============|==================================|
  |   18   |     2      |     3      |     0      |     2      |L_18(u)=(u.t0)(0.333333333333,0.333333333333,0.0)  |
  |========|============|============|============|============|==================================|
  |   19   |     2      |     3      |     1      |     2      |L_19(u)=(u.t1)(0.333333333333,0.333333333333,0.0)  |
  |========|============|============|============|============|==================================|


\endverbatim

  The DefaultBasisFactory will select this basis
  if the following parameters are specified:
  \verbatim
  |=======================|===================================|
  |  EField               |  FIELD_FORM_1                     |
  |-----------------------|-----------------------------------|
  |  ECell                |  CELL_TET                         |
  |-----------------------|-----------------------------------|
  |  EReconstructionSpace |  RECONSTRUCTION_SPACE_INCOMPLETE  |
  |-----------------------|-----------------------------------|
  |  degree               |  2                                |
  |-----------------------|-----------------------------------|
  |  EBasis               |  BASIS_FEM_FIAT                   |
  |-----------------------|-----------------------------------|
  |  ECoordinates         |  COORDINATES_CARTESIAN            |
  |=======================|===================================|
  \endverbatim

*/

template<class Scalar>
class Basis_F1_TET_I2_FEM_FIAT: public Basis<Scalar> {
  private:
  
  /** \brief Dimension of the space spanned by the basis = number of degrees of freedom.
  */
  int numDof_;
  
  /**\brief Lookup table for the DoF's local enumeration (DoF Id) by its local DoF tag
  */
  Teuchos::Array<Teuchos::Array<Teuchos::Array<int> > > tagToEnum_;
  
  /**\brief Lookup table for the DoF's local DoF tag by its local enumeration (DoF Id)
  */
  Teuchos::Array<LocalDofTag> enumToTag_;
  
  /**\brief "true" if both lookup arrays have been set by initialize()
  */
  bool isSet_;

  /**\brief coefficients of nodal basis in terms of orthogonal polynomials */
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm0_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm1_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm2_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats0_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats1_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats2_;

/* \brief Static data array that provides the Vandermonde and derivative matrices.  They need to
     be static data members because of the templating w.r.t type */
  #ifndef DOXYGEN_SHOULD_SKIP_THIS
  static Scalar *get_vdm0_data () {
    static Scalar vdm0_data [] = { 1.084098254686759e-02 , 1.084098254686282e-02 , 1.064970911441493e-01 , -5.797155785391101e-02 , -5.797155785391100e-02 , 1.064970911441492e-01 , -1.543438914027186e-01 , 6.923076923076905e-02 , 1.543438914027133e-01 , -6.923076923076935e-02 , -1.551274775980726e-16 , 2.054028946367911e-16 , 3.714027149321250e-01 , 5.387333785356757e-15 , -1.550226244343873e-01 , -2.394570135746627e-01 , 2.394570135746630e-01 , 1.550226244343875e-01 , -1.222039843992197e-16 , 3.460743374272771e-01 , -7.575757575757631e-01 , 7.575757575757618e-01 , -3.257575757575764e-01 , 1.791432993539973e-17 , -9.814543628311486e-16 , 3.257575757575802e-01 , -4.166666666666560e-01 , 5.847856258255443e-16 , -4.166666666666610e-01 , -2.247035637691932e-17 , 1.325986850467795e-15 , -3.649024215072375e-16 , -4.166666666666601e-01 , 8.333333333333176e-01 , -2.985083337164859e-15 , 3.928371520358362e-15 , -6.413975939790714e-15 , 3.575882147490274e-15 , 6.515151515151564e-01 , -3.257575757575754e-01 , -6.890756302520100e-02 , -6.890756302521972e-02 , 2.987394957983122e-01 , -4.210084033613450e-01 , -4.210084033613458e-01 , 2.987394957983305e-01 , -1.323529411764685e-01 , -4.353824174611340e-16 , 1.323529411764683e-01 , 1.752059785231647e-16 , 8.802624247980968e-16 , 2.873487593707245e-16 , -3.088235294117660e-01 , 1.478329454961682e-15 , -1.764705882352965e-01 , -2.647058823529380e-01 , 2.647058823529364e-01 , 1.764705882352978e-01 , 1.749769020463398e-14 , 1.554621848738766e-02 , -2.730769230768880e-02 , -2.730769230769577e-02 , -1.961538461538722e-02 , 1.084615384615379e-01 , 1.084615384615377e-01 , -1.961538461538111e-02 , -2.423076923076927e-01 , 3.461538461538461e-01 , 2.423076923076914e-01 , -3.461538461538464e-01 , 4.219339580013280e-16 , 1.132980640976481e-16 , 9.230769230769179e-02 , 1.421518855927663e-15 , -6.923076923076922e-02 , -1.384615384615381e-01 , 1.384615384615373e-01 , 6.923076923076976e-02 , 5.888732291505980e-15 , -2.603846153846186e-01 , -7.858945272999504e-15 , 9.959176260703412e-15 , 1.234195117757984e-14 , 3.236171169421575e-16 , 2.723405268099371e-15 , -2.639199041542559e-14 , -1.865185870324335e-14 , -5.148807606161730e-17 , -2.303506404366625e-15 , -2.527395859940051e-18 , -2.624950777654894e-15 , 3.336020320378562e-17 , -4.706217294380761e-15 , 1.853848182057566e-14 , 1.139392457941850e-14 , -1.375737764055328e-14 , 1.895892848575953e-14 , -1.397466529328914e-14 , -3.637404129815032e-14 , 1.056738782778727e-14 , 4.090909090909025e-01 , -4.090909090909035e-01 , -4.090909090909106e-01 , 1.170938346284345e-17 , -1.070324384677690e-15 , 4.090909090909139e-01 , 1.223326995258844e-14 , 6.222236267894310e-16 , 7.396860901565105e-15 , -1.537398680584445e-16 , 1.240327285323417e-15 , -3.850001914496026e-16 , 8.298917109073045e-15 , -1.879052469178077e-14 , -2.733924198139448e-15 , 3.781697177629439e-15 , -6.057654378111010e-15 , 3.268219028740305e-15 , 8.181818181818239e-01 , -4.090909090909096e-01 , 3.333333333333344e-01 , -3.333333333333345e-01 , 8.333333333333380e-02 , 1.788933584601082e-17 , -7.676151381197371e-17 , -8.333333333333362e-02 , -4.166666666666684e-01 , 4.289374844895777e-18 , -4.166666666666686e-01 , 6.583817692418226e-17 , 7.827939685345342e-17 , -3.026279313950164e-17 , -4.166666666666681e-01 , 8.333333333333368e-01 , -8.890457814381136e-17 , 2.298508605669269e-16 , -3.825065264528860e-16 , 2.151057110211241e-16 , -1.666666666666676e-01 , 8.333333333333391e-02 , 1.928571428571476e-01 , 1.928571428571377e-01 , 1.928571428571392e-01 , -3.857142857142859e-01 , -3.857142857142860e-01 , 1.928571428571480e-01 , 5.082739784612045e-16 , -3.012455736250974e-16 , -1.547373340571312e-15 , 6.133873790836741e-17 , 2.968545548265311e-16 , 2.017429192452402e-16 , -9.887923813067800e-16 , 1.477984401532240e-15 , -9.939965517347105e-16 , 1.431146867680866e-15 , -2.095545958979983e-15 , 1.642783131750036e-15 , 8.604228440844963e-15 , -5.785714285714320e-01 , 1.310924369747907e-01 , 1.310924369747893e-01 , -1.260504201680966e-03 , 1.789915966386552e-01 , 1.789915966386551e-01 , -1.260504201680536e-03 , -1.323529411764713e-01 , -2.290309326739848e-16 , 1.323529411764703e-01 , 1.066719412454176e-16 , 1.214306433183765e-16 , 9.288224486411756e-17 , -3.088235294117649e-01 , 1.082467449009528e-15 , -1.764705882352935e-01 , -2.647058823529417e-01 , 2.647058823529417e-01 , 1.764705882352937e-01 , 2.914335439641036e-16 , -8.445378151260580e-02 , 6.899418228830169e-02 , 6.899418228829816e-02 , -1.896961861667865e-02 , -4.785261797026519e-02 , -4.785261797026522e-02 , -1.896961861667599e-02 , -8.796380090497784e-02 , 2.769230769230770e-01 , 8.796380090497682e-02 , -2.769230769230768e-01 , 1.291420312701796e-16 , -4.669862044802409e-17 , -2.790950226244346e-01 , 9.870576578308032e-16 , 8.579185520362001e-02 , 1.009954751131222e-01 , -1.009954751131225e-01 , -8.579185520362000e-02 , 2.713107516427726e-15 , 7.211247575953314e-02 };
    return vdm0_data ;
  }

  static Scalar *get_vdm1_data () {
    static Scalar vdm1_data [] = { -3.373607438313547e-02 , 4.457705693000054e-02 , 6.151622233975394e-02 , -9.098577892695535e-02 , 3.301422107304492e-02 , 4.498086880439597e-02 , -1.712830568124687e-01 , 6.461538461538473e-02 , -1.693916540975312e-02 , -4.615384615384603e-03 , 1.259999999999997e-01 , -5.999999999999983e-02 , 5.859024635495248e-02 , 2.542222222222215e-01 , 3.004886877828055e-01 , -2.157285067873309e-01 , 2.372850678733112e-02 , 4.555113122171945e-01 , 4.174646464646422e-01 , -3.569515451868191e-02 , -3.750063661828469e-01 , 3.825693913929326e-01 , 3.923733129615574e-01 , -9.579831932773099e-02 , -9.579831932773035e-02 , 7.181308887191077e-01 , -4.068627450980445e-01 , 4.919533964371648e-16 , -9.803921568624620e-03 , 5.789041384053595e-17 , -7.377046246595096e-16 , -2.574138677087729e-16 , 7.843137254902112e-02 , 4.166666666666682e-01 , 4.852941176470650e-01 , -3.970588235294191e-01 , 3.970588235294208e-01 , -4.852941176470663e-01 , 3.257575757575517e-01 , 2.890119684237411e-01 , 6.547406841524947e-02 , -1.343816314404601e-01 , -1.787327052032987e-01 , 1.823529411764704e-01 , -6.033613445378161e-01 , 4.774722010016193e-01 , -8.800186741362986e-02 , -2.858740498322449e-17 , 4.435107376283838e-02 , 6.606090233514737e-17 , -2.142857142857132e-01 , -8.231818560358238e-17 , -6.909430438842133e-02 , -1.706349206349218e-01 , -1.953781512605047e-01 , 8.193277310924521e-02 , 3.466386554621820e-01 , -1.890756302520882e-02 , -1.295093795093681e-01 , 7.252779899838235e-02 , 4.344932844933121e-02 , -7.075702075702432e-02 , -9.437118437118797e-02 , 2.994505494505524e-02 , 7.851648351648315e-02 , 7.475579975580959e-02 , -2.186935286935215e-01 , 3.230769230769232e-01 , 2.361416361416388e-02 , -2.307692307692314e-02 , 2.014285714285721e-01 , -2.999999999999998e-01 , -2.100122100121478e-03 , 9.650793650792945e-02 , 1.410989010988951e-01 , -1.206593406593344e-01 , 1.780219780219021e-02 , 2.103296703296772e-01 , -2.323015873015747e-01 , -1.404151404151657e-02 , -4.090909090909188e-01 , 4.090909090909192e-01 , 4.090909090909141e-01 , 2.445960101127298e-16 , 5.819997261902188e-16 , -4.090909090909187e-01 , 6.869504964868156e-16 , 5.271390962624523e-16 , 5.218048215738236e-15 , -4.401860820291148e-17 , -2.701831813833877e-16 , -4.013716442541337e-16 , 4.565792188770956e-15 , -6.494804694057166e-15 , 3.066991105526995e-15 , -3.705369344686460e-15 , 4.579669976578771e-15 , -4.302114220422482e-15 , -8.181818181818320e-01 , 4.090909090909139e-01 , 1.402597402597472e-01 , -2.688311688311771e-01 , -2.688311688311781e-01 , 1.285714285714283e-01 , 1.285714285714268e-01 , 1.402597402597561e-01 , 8.704842402451618e-15 , -2.057544672834366e-16 , 8.881784197001252e-16 , 4.521123059264553e-17 , 1.434399474198322e-15 , 1.176630407689894e-16 , 2.553512956637860e-15 , -8.139322549283179e-15 , -4.602221381766469e-15 , 6.191228085761225e-15 , -9.183626081821217e-15 , 6.369904603786836e-15 , 4.090909090909326e-01 , -1.168831168832002e-02 , 1.275910364145697e-01 , -2.057422969187713e-01 , -1.959383753501423e-01 , -1.008403361344581e-02 , -1.008403361344619e-02 , -2.792717086834699e-01 , -4.068627450980398e-01 , -2.744115698560812e-16 , -9.803921568629286e-03 , 1.827219473816977e-16 , 5.637038145295259e-16 , 1.573922741270051e-16 , 7.843137254901836e-02 , 4.166666666666695e-01 , 4.852941176470585e-01 , -3.970588235294111e-01 , 3.970588235294101e-01 , -4.852941176470576e-01 , -8.333333333332815e-02 , -1.278711484593864e-01 , -5.844155844163604e-03 , 1.987012987013076e-01 , 1.987012987013083e-01 , -1.928571428571424e-01 , -1.928571428571404e-01 , -5.844155844173415e-03 , -9.998078753792328e-15 , 1.477089934739939e-16 , -6.834810495348620e-16 , -6.051203375184722e-17 , -1.805467667731486e-15 , 2.457073173395274e-17 , -2.407796184655808e-15 , 8.970255094276069e-15 , 5.699000299452806e-15 , -7.370840049425453e-15 , 1.093049262212986e-14 , -7.488801245791876e-15 , -2.045454545454799e-01 , -1.870129870129780e-01 , -1.634411340294147e-02 , 1.474365503777323e-01 , 1.030854766148947e-01 , -1.764705882352913e-02 , 1.966386554621862e-01 , -1.043459808165827e-01 , -8.800186741364140e-02 , -7.550451691824833e-17 , 4.435107376283740e-02 , -2.207029047365805e-17 , -2.142857142857153e-01 , -1.394419519087919e-16 , -6.909430438842440e-02 , -1.706349206349113e-01 , -1.953781512604984e-01 , 8.193277310923688e-02 , 3.466386554621941e-01 , -1.890756302521722e-02 , 6.854256854238183e-03 , -4.565401918342522e-02 , -1.697044132338374e-02 , 8.596462361168350e-02 , 4.541129458776587e-02 , 1.378797672915381e-02 , -6.164059469941750e-02 , -6.438091320444206e-02 , -4.741047188105806e-02 , 2.584615384615387e-01 , 4.055332902391781e-02 , -1.846153846153863e-02 , 7.542857142857119e-02 , -2.400000000000000e-01 , -6.069036845507434e-02 , -1.577142857142885e-01 , -1.593897866839064e-01 , 9.506916612799146e-02 , -5.926308985133988e-03 , -2.451816418875223e-01 , 5.477922077922071e-02 , 8.666627490158471e-03 };
    return vdm1_data ;
  }

  static Scalar *get_vdm2_data () {
    static Scalar vdm2_data [] = { -7.966953598326389e-02 , 9.051051853013060e-02 , -4.717818202131728e-02 , 7.490411549233431e-03 , -6.546196940314733e-02 , 1.536752731654757e-01 , -1.665519085125962e-02 , -3.871794871794921e-02 , 1.376887005514481e-01 , -1.079487179487178e-01 , 7.295238095238070e-02 , -1.033333333333329e-01 , 1.140858850663036e-02 , 3.485855379188594e-01 , -1.443684550743445e-01 , 2.339857789269624e-01 , 4.734427925016096e-01 , 1.065416936005906e-02 , 2.312344075677453e-01 , 5.741996492976715e-02 , -3.892985445926707e-01 , 3.682772129831045e-01 , -1.965642200935641e-02 , 1.627020038784780e-02 , 1.627020038784854e-02 , 3.061011537482011e-01 , -8.046003016591285e-01 , 5.769230769230783e-02 , 3.879336349924605e-01 , -5.769230769230804e-02 , -9.595296462191326e-16 , 3.948792057830107e-17 , 3.349924585218713e-01 , 4.166666666666671e-01 , -3.027149321266930e-01 , 3.651583710407196e-01 , -3.651583710407181e-01 , 3.027149321266925e-01 , 3.257575757575581e-01 , 7.532741768036563e-02 , 1.035741165152944e-01 , -1.724816795405040e-01 , 1.290269643210782e-02 , -5.907563025210170e-02 , -3.619327731092444e-01 , 2.858367993662070e-01 , -3.177373171490875e-01 , 4.999999999999999e-02 , -1.853843759726120e-01 , 5.000000000000019e-02 , 3.028571428571429e-01 , -1.000000000000000e-01 , -7.401182695300387e-03 , -2.940211640211575e-01 , -3.680672268907018e-02 , 1.147899159663815e-01 , 3.794957983193332e-01 , 1.396638655462129e-01 , 7.007696007695648e-02 , -2.726537079478455e-02 , 9.075813075813416e-02 , -1.180658230658284e-01 , 4.990731490731228e-02 , -1.483516483514585e-03 , 1.099450549450563e-01 , -6.952269952270645e-02 , -4.102808302808417e-01 , 4.730769230769238e-01 , -1.679731379731410e-01 , 1.269230769230766e-01 , -1.114285714285708e-01 , 1.499999999999996e-01 , -1.225885225885559e-02 , 1.168253968254111e-01 , 5.967032967033773e-02 , -1.578021978022057e-01 , -1.934065934065211e-02 , 1.289010989010907e-01 , -1.580014430014475e-01 , -5.119158619158466e-02 , -3.484848484848525e-01 , 3.484848484848533e-01 , 1.515151515152184e-02 , 1.477767561097743e-16 , 1.159662643690496e-15 , -1.515151515152774e-02 , 3.333333333333249e-01 , 7.005301286971966e-17 , 3.333333333333317e-01 , -1.263095530945613e-17 , -1.098079960293319e-15 , -1.004377787536259e-16 , 3.333333333333305e-01 , -6.666666666666576e-01 , 4.602221381766469e-15 , -5.660402702112322e-15 , 7.967584925161475e-15 , -6.064593272014918e-15 , -3.030303030304843e-02 , 1.515151515152111e-02 , 1.447975553857933e-01 , -2.642933537051215e-01 , -5.252864782277100e-02 , 1.361344537815093e-02 , 1.361344537814978e-02 , 3.565622612681532e-01 , 2.117647058823598e-01 , 7.188260403578894e-17 , -2.117647058823506e-01 , -8.174884380540703e-17 , 1.015463754749923e-15 , -5.059158387360485e-17 , -1.058823529411732e-01 , -8.146261443187086e-15 , -3.176470588235319e-01 , 4.235294117647093e-01 , -4.235294117647116e-01 , 3.176470588235331e-01 , 4.090909090909230e-01 , 8.058059587470801e-02 , 1.373453996983472e-01 , -1.959879336349987e-01 , -2.111613876359698e-04 , -7.194570135747173e-03 , -7.194570135747630e-03 , -8.354449472095993e-02 , -2.208898944193071e-01 , -5.769230769230775e-02 , -1.957767722473628e-01 , 5.769230769230782e-02 , 5.816609130113171e-16 , -3.249726605435849e-17 , -7.224736048265611e-02 , 4.166666666666703e-01 , 9.095022624434353e-02 , -8.280542986425260e-02 , 8.280542986425155e-02 , -9.095022624434299e-02 , -8.333333333332441e-02 , -6.455505279039361e-03 , -1.515151515152090e-02 , 2.080086580086647e-01 , 9.848484848485710e-02 , -6.428571428571377e-02 , -3.214285714285690e-01 , 9.437229437227643e-02 , 1.095238095237970e-01 , 1.571076710567276e-16 , 1.095238095238075e-01 , 1.660862202976232e-17 , 2.571428571428553e-01 , 4.475722093291723e-18 , -1.904761904762259e-02 , 3.809523809525079e-02 , 1.285714285714356e-01 , -2.571428571428658e-01 , -2.571428571428451e-01 , 1.285714285714196e-01 , -2.612554112554359e-01 , -1.586580086580004e-01 , -3.323204029086757e-02 , 1.643244772656574e-01 , 2.357128710070202e-02 , 2.378151260504299e-02 , 1.552100840336149e-01 , -2.483179130238212e-02 , 8.400248988485728e-03 , -4.999999999999998e-02 , 1.407531901649555e-01 , -5.000000000000013e-02 , -1.314285714285719e-01 , 1.000000000000001e-01 , -6.412075941487760e-02 , -1.805820105820131e-01 , -5.394957983193491e-02 , -5.092436974789778e-02 , 2.137815126050416e-01 , 1.225210084033630e-01 , -1.697450697451226e-02 , -3.373963726904466e-02 , -3.840670875965227e-02 , 1.074008910479537e-01 , -2.168153850506532e-02 , 2.930833872009041e-03 , -5.078345184227621e-02 , 2.711919888395735e-03 , 4.111862864804833e-02 , 1.784615384615381e-01 , 1.290824295530192e-01 , -9.846153846153823e-02 , 5.371428571428511e-02 , -7.999999999999971e-02 , -4.130412506882956e-02 , -1.964867724867822e-01 , -1.024692954105416e-02 , 3.678345184228184e-02 , -6.421202327085246e-02 , -9.603878474466017e-02 , 5.067917267917552e-02 , 1.071665154018040e-02 };
    return vdm2_data ;
  }

  static Scalar *get_dmats0_data() {
    static Scalar dmats0_data[] = { 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 5.656854249492381e+00 , -1.776356839400250e-15 , -8.881784197001252e-16 , -8.881784197001252e-16 , 0.000000000000000e+00 , -2.583561076591731e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.077541110202794e-16 , -8.881784197001252e-16 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , -3.434996394210077e-15 , 1.697056274847714e+01 , 5.518433208703432e-16 , 7.200108702852338e-16 , -7.105427357601002e-15 , 8.881784197001251e-15 , 5.329070518200751e-15 , -6.055934969857329e-15 , -3.768221900841061e-15 , -2.085912009718399e-15 , 2.828427124746190e+00 , 8.367133432421036e-31 , 9.428090415820634e+00 , -9.428090415820636e-01 , 0.000000000000000e+00 , 3.983730122881619e-15 , -2.664535259100376e-15 , 3.552713678800501e-15 , 6.280369834735097e-16 , 0.000000000000000e+00 , 2.828427124746191e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 8.485281374238570e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.991865061440809e-15 , -1.776356839400250e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 };
    return dmats0_data;
  }

  static Scalar *get_dmats1_data() {
    static Scalar dmats1_data[] = { 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 2.828427124746190e+00 , -8.881784197001251e-16 , -4.440892098500626e-16 , -4.440892098500626e-16 , 0.000000000000000e+00 , -1.291780538295865e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 5.387705551013972e-17 , -4.440892098500626e-16 , 8.485281374238571e+00 , -3.552713678800500e-15 , 1.776356839400250e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , -3.226279360870944e-16 , -3.552713678800501e-15 , 0.000000000000000e+00 , 2.826166425630795e-15 , 1.776356839400250e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.414213562373093e+00 , 8.485281374238570e+00 , -9.428090415820630e-01 , -4.714045207910313e-01 , -5.329070518200751e-15 , 4.306358058968712e-15 , 3.552713678800501e-15 , -3.108624468950438e-15 , -1.684382952588527e-15 , -1.110223024625157e-15 , 1.414213562373092e+00 , 1.414213562373095e+01 , 4.714045207910317e+00 , -4.714045207910316e-01 , -3.552713678800501e-15 , 1.442636293724256e-14 , 3.552713678800501e-15 , -5.329070518200751e-15 , -2.350516767363621e-15 , -1.332267629550188e-15 , 1.414213562373096e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 4.242640687119285e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 9.959325307204047e-16 , -8.881784197001252e-16 , -2.828427124746193e+00 , 3.552713678800502e-15 , 1.885618083164127e+01 , 9.428090415820634e-01 , 0.000000000000000e+00 , 1.108915748048262e-14 , 0.000000000000000e+00 , 3.552713678800501e-15 , -1.516215403173636e-15 , 2.664535259100376e-15 , 4.242640687119286e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.272792206135786e+01 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 2.099619172461089e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 };
    return dmats1_data;
  }

  static Scalar *get_dmats2_data() {
    static Scalar dmats2_data[] = { 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 2.828427124746190e+00 , -8.881784197001251e-16 , -4.440892098500626e-16 , -4.440892098500626e-16 , 0.000000000000000e+00 , -1.291780538295865e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 5.387705551013972e-17 , -4.440892098500626e-16 , 2.828427124746190e+00 , -8.881784197001251e-16 , -8.881784197001252e-16 , -4.440892098500626e-16 , 0.000000000000000e+00 , -1.291780538295865e-15 , 0.000000000000000e+00 , -8.881784197001252e-16 , 5.387705551013972e-17 , -4.440892098500626e-16 , 1.131370849898476e+01 , -3.552713678800501e-15 , -1.776356839400250e-15 , -1.776356839400250e-15 , 0.000000000000000e+00 , -5.167122153183461e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 2.155082220405589e-16 , -1.776356839400250e-15 , 1.414213562373093e+00 , 8.485281374238571e+00 , -9.428090415820628e-01 , -4.714045207910313e-01 , -7.105427357601002e-15 , 4.306358058968712e-15 , 3.552713678800501e-15 , -3.996802888650564e-15 , -2.572561372288652e-15 , -1.554312234475219e-15 , 1.414213562373094e+00 , 2.828427124746190e+00 , 4.714045207910318e+00 , -4.714045207910318e-01 , -1.332267629550188e-15 , 5.544578740241310e-15 , -1.332267629550188e-15 , 0.000000000000000e+00 , -5.741599279633705e-16 , 2.220446049250313e-16 , 1.414213562373092e+00 , 1.697056274847714e+01 , 1.077541110202802e-16 , 4.242640687119286e+00 , -7.105427357601002e-15 , 8.881784197001251e-15 , 3.552713678800501e-15 , -5.167756550157204e-15 , -2.556781148080097e-15 , -2.664535259100376e-15 , 1.414213562373094e+00 , 2.220446049250317e-16 , 7.542472332656508e+00 , -4.714045207910318e-01 , 0.000000000000000e+00 , 3.499153821777232e-15 , -1.543153930928705e-15 , 0.000000000000000e+00 , 1.202196911436880e-15 , 8.881784197001252e-16 , 1.414213562373094e+00 , 1.776356839400251e-15 , 1.697056274847714e+01 , 4.242640687119286e+00 , 0.000000000000000e+00 , 7.267375722618292e-15 , -2.994333975045686e-15 , 0.000000000000000e+00 , 1.884110950420530e-15 , 5.329070518200751e-15 , -7.071067811865475e+00 , 3.552713678800501e-15 , 0.000000000000000e+00 , 2.121320343559643e+01 , 0.000000000000000e+00 , 1.001161637027983e-14 , 4.131495527425913e-15 , 3.552713678800501e-15 , 4.710277376051325e-15 , 0.000000000000000e+00 };
    return dmats2_data;
  }
#endif


  public:

  /** \brief Constructor.
  */
  Basis_F1_TET_I2_FEM_FIAT() : numDof_(20), isSet_(false) , vdm0_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_vdm0_data(),20,20,10) ) ),vdm1_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_vdm1_data(),20,20,10) ) ),vdm2_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_vdm2_data(),20,20,10) ) ),dmats0_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_dmats0_data(),10,10,10) ) ),dmats1_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_dmats1_data(),10,10,10) ) ),dmats2_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TET_I2_FEM_FIAT::get_dmats2_data(),10,10,10) ) ) { }
  
  /** \brief Initializes arrays needed for the lookup of the local enumeration (DoF Id) of a 
    degree-of-freedom by its local DoF tag and the reverse lookup of the DoF tag by DoF Id.
   */
  void initialize();
  
  
  /** \brief Returns FieldContainer with multi-indexed quantity with the values of an operator 
  applied to a set of FEM basis functions, evaluated at a set of
  points in a <strong>reference</strong> cell. The rank of the return
  FieldContainer argument depends on the number of points, number of
  basis, functions, their rank, and the rank of the operator applied to them; see 
  FieldContainer::resize(int,int,EField,EOperator,int) for summary of
  the admissible index combinations.
  In particular, the admissible range of the <var>operatorType</var> argument depends on the rank of 
  the basis functions and the space dimension.Because FEM
  reconstruction relies on COMPLETE or INCOMPLETE polynomials, i.e.,
  smooth local spaces, the admissible range of <var>operatorType</var>
  always includes VALUE, D0, D1,...,D10. If derivative order exceeds
  polynomial degree, output container is filled with 0. 
 
      \param outputValues   [out]         - FieldContainer with the computed values (see
                                            implementation for index ordering)
      \param inputPoints     [in]         - evaluation points on the reference cell  
      \param operatorType    [in]         - the operator being applied to the basis function
  */    

  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const EOperator                        operatorType) const;
  
  
  /** \brief This method is intended for FVD reconstructions and should not be used here. Its 
    invocation will throw an exception. 
  */  
  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const Cell<Scalar>&                    cell) const;

  
  int getNumLocalDof() const;
  
  
  int getLocalDofEnumeration(const LocalDofTag dofTag);

  
  LocalDofTag getLocalDofTag(int id);

  
  const Teuchos::Array<LocalDofTag> & getAllLocalDofTags();

  
  ECell getCellType() const;

  
  EBasis getBasisType() const;

  
  ECoordinates getCoordinateSystem() const;

  
  int getDegree() const;

};

} // namespace Intrepid

#include "Intrepid_F1_TET_I2_FEM_FIATDef.hpp"

#endif

