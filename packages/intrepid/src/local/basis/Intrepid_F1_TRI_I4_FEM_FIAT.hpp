#ifndef INTREPID_F1_TRI_I4_FEM_FIAT_HPP
#define INTREPID_F1_TRI_I4_FEM_FIAT_HPP
#include "Intrepid_Basis.hpp"
#include "Intrepid_RealSpace.hpp"
#include "Intrepid_Utils.hpp"
#include "Intrepid_Tabulate.hpp"
#include "Intrepid_FieldContainer.hpp"
#include "Teuchos_Array.hpp"
#include "Teuchos_BLAS_types.hpp"

namespace Intrepid {

/** \class Intrepid::Basis_F1_TRI_I4_FEM_FIAT
  \brief Implementation of FIAT FEM basis functions of degree 4 for 1-forms on TRI cells. 
  Reconstruction space type is INCOMPLETE. Definition of the DoF set 
  for this basis, its enumeration and the associated local DoF tags are as follows,

\verbatim
  =================================================================================================
  |        |                degree-of-freedom-tag              |                                  |
  | DoF Id |---------------------------------------------------|          DoF definition          |
  |        |  subc dim  |  subc id   | subc DoFId |subc num DoF|                                  |
  |========|============|============|============|============|==================================|
  |    0   |     1      |     0      |     0      |     4      |           L_0(u)=(u.t)(0.2,0.0)  |
  |========|============|============|============|============|==================================|
  |    1   |     1      |     0      |     1      |     4      |           L_1(u)=(u.t)(0.4,0.0)  |
  |========|============|============|============|============|==================================|
  |    2   |     1      |     0      |     2      |     4      |           L_2(u)=(u.t)(0.6,0.0)  |
  |========|============|============|============|============|==================================|
  |    3   |     1      |     0      |     3      |     4      |           L_3(u)=(u.t)(0.8,0.0)  |
  |========|============|============|============|============|==================================|
  |    4   |     1      |     1      |     0      |     4      |           L_4(u)=(u.t)(0.8,0.2)  |
  |========|============|============|============|============|==================================|
  |    5   |     1      |     1      |     1      |     4      |           L_5(u)=(u.t)(0.6,0.4)  |
  |========|============|============|============|============|==================================|
  |    6   |     1      |     1      |     2      |     4      |           L_6(u)=(u.t)(0.4,0.6)  |
  |========|============|============|============|============|==================================|
  |    7   |     1      |     1      |     3      |     4      |           L_7(u)=(u.t)(0.2,0.8)  |
  |========|============|============|============|============|==================================|
  |    8   |     1      |     2      |     0      |     4      |           L_8(u)=(u.t)(0.0,0.8)  |
  |========|============|============|============|============|==================================|
  |    9   |     1      |     2      |     1      |     4      |           L_9(u)=(u.t)(0.0,0.6)  |
  |========|============|============|============|============|==================================|
  |   10   |     1      |     2      |     2      |     4      |          L_10(u)=(u.t)(0.0,0.4)  |
  |========|============|============|============|============|==================================|
  |   11   |     1      |     2      |     3      |     4      |          L_11(u)=(u.t)(0.0,0.2)  |
  |========|============|============|============|============|==================================|
  |   12   |     2      |     0      |     0      |    12      |          L_12(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   13   |     2      |     0      |     1      |    12      |          L_13(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   14   |     2      |     0      |     2      |    12      |          L_14(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   15   |     2      |     0      |     3      |    12      |          L_15(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   16   |     2      |     0      |     4      |    12      |          L_16(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   17   |     2      |     0      |     5      |    12      |          L_17(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   18   |     2      |     0      |     6      |    12      |          L_18(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   19   |     2      |     0      |     7      |    12      |          L_19(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   20   |     2      |     0      |     8      |    12      |          L_20(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   21   |     2      |     0      |     9      |    12      |          L_21(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   22   |     2      |     0      |    10      |    12      |          L_22(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|
  |   23   |     2      |     0      |    11      |    12      |          L_23(u)=IntegralMoment  |
  |========|============|============|============|============|==================================|


\endverbatim

  The DefaultBasisFactory will select this basis
  if the following parameters are specified:
  \verbatim
  |=======================|===================================|
  |  EField               |  FIELD_FORM_1                     |
  |-----------------------|-----------------------------------|
  |  ECell                |  CELL_TRI                         |
  |-----------------------|-----------------------------------|
  |  EReconstructionSpace |  RECONSTRUCTION_SPACE_INCOMPLETE  |
  |-----------------------|-----------------------------------|
  |  degree               |  4                                |
  |-----------------------|-----------------------------------|
  |  EBasis               |  BASIS_FEM_FIAT                   |
  |-----------------------|-----------------------------------|
  |  ECoordinates         |  COORDINATES_CARTESIAN            |
  |=======================|===================================|
  \endverbatim

*/

template<class Scalar>
class Basis_F1_TRI_I4_FEM_FIAT: public Basis<Scalar> {
  private:
  
  /** \brief Dimension of the space spanned by the basis = number of degrees of freedom.
  */
  int numDof_;
  
  /**\brief Lookup table for the DoF's local enumeration (DoF Id) by its local DoF tag
  */
  Teuchos::Array<Teuchos::Array<Teuchos::Array<int> > > tagToEnum_;
  
  /**\brief Lookup table for the DoF's local DoF tag by its local enumeration (DoF Id)
  */
  Teuchos::Array<LocalDofTag> enumToTag_;
  
  /**\brief "true" if both lookup arrays have been set by initialize()
  */
  bool isSet_;

  /**\brief coefficients of nodal basis in terms of orthogonal polynomials */
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm0_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm1_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats0_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats1_;

/* \brief Static data array that provides the Vandermonde and derivative matrices.  They need to
     be static data members because of the templating w.r.t type */
  #ifndef DOXYGEN_SHOULD_SKIP_THIS
  static Scalar *get_vdm0_data () {
    static Scalar vdm0_data [] = { 2.103657719792006e-17 , -1.998474833802405e-16 , -3.155486579688008e-17 , 1.577743289844004e-17 , -3.155486579688008e-17 , 1.262194631875203e-16 , 6.836887589324019e-17 , 1.380525378613504e-16 , -1.051828859896003e-17 , -3.733992452630810e-16 , 3.707696731133410e-16 , -1.932735530058905e-16 , 1.999999999999058e+00 , 8.414630879168023e-16 , 0.000000000000000e+00 , -5.890241615417616e-15 , 2.187804028583686e-15 , -2.103657719792006e-15 , -3.155486579688009e-16 , -1.682926175833605e-16 , 1.619816444239844e-15 , 6.731704703334418e-16 , -1.598779867041924e-15 , -5.048778527500814e-16 , 2.342465808513658e-16 , -2.582764620095029e-16 , 5.351712833287748e-16 , 6.507442887838478e-16 , -2.676073310592694e-16 , -8.016624419928251e-19 , 2.612948755289771e-16 , 3.842159336184495e-16 , 4.105386860038644e-16 , 3.611406147516180e-16 , 2.136112600271517e-15 , 2.078535888186558e-16 , -3.883688867569814e-15 , 1.199999999999435e+01 , 9.129897149294369e-16 , -3.468081370895136e-14 , -9.248551212233228e-16 , -1.647205199941091e-17 , 4.047559046427323e-16 , 1.336083155439608e-15 , 1.789020209267002e-15 , 4.705366689600401e-15 , 4.120724353616837e-15 , -1.227982324096356e-14 , 2.966994722979900e-16 , 1.390770446519388e-16 , 2.428370685226821e-17 , 7.170454174889149e-16 , -2.217122549786535e-16 , 5.094014927910276e-16 , -3.799150583466661e-16 , 2.163999408807270e-16 , 2.152476901716120e-16 , 1.087512014365145e-16 , 6.374035889128258e-16 , -1.167600249804771e-16 , -1.093651893656831e-15 , 4.771954150968432e-15 , 3.999999999998120e+00 , 3.024237849340026e-15 , -1.757493726055341e-14 , -2.979901224562184e-16 , 8.519980502939322e-16 , 5.658763897767993e-16 , 2.510040216633870e-15 , -1.114090808948683e-16 , -8.677446988340184e-15 , -5.270158998835499e-15 , 9.074539249643177e-17 , -2.187631992873681e-17 , 2.034200444808038e-16 , -5.478505341304776e-16 , 1.495322318929588e-16 , -5.871632390366810e-18 , 2.858304210180164e-16 , -2.473799427125587e-16 , 3.381444463898629e-16 , -2.187246592882681e-16 , -3.933172079586926e-16 , -9.569549539183327e-16 , 2.375215909372619e-16 , -3.911642196133616e-15 , 1.272403893640345e-15 , 2.999999999998591e+01 , 3.811529678031736e-15 , -8.622560351405914e-16 , -1.663306740062008e-15 , -6.665704602594035e-17 , 4.336851041589380e-17 , -4.364591370611959e-15 , -7.279960190448645e-15 , 8.743932972967404e-15 , 2.260073956292013e-16 , 4.240655627352078e-16 , -5.493336888211199e-16 , 8.306707588726298e-16 , -1.605584832838416e-16 , -2.637211670287846e-16 , 1.313305632355598e-15 , -3.610816089105867e-16 , -8.077649696581789e-16 , 1.663925868206892e-15 , 5.849320483744948e-16 , 1.760254107798236e-16 , -2.743313452480643e-15 , 3.344262682129480e-15 , 1.256598338253919e-15 , -1.288331522356339e-14 , 1.799999999999153e+01 , -6.136700763298203e-15 , -1.044920807798349e-15 , -9.682099200868419e-15 , 2.267280194969898e-15 , -3.281183715030979e-15 , -1.091480408963905e-14 , -7.104128432576387e-15 , -3.196904340443315e-16 , 4.264778530119839e-16 , -2.722602319015084e-16 , 1.692048500256257e-16 , 6.317593913607219e-17 , -1.739250800905432e-17 , -7.797449046960474e-16 , 3.967672281603701e-16 , 6.526361437557078e-17 , -3.601920886583492e-16 , 2.246341368460204e-16 , -6.733151586252629e-17 , 4.207819931930622e-16 , -1.163050907828411e-15 , -1.912181240977134e-15 , 2.938946511319102e-15 , -4.023957348806328e-15 , 5.999999999997181e+00 , 4.687255734025378e-16 , 9.930435304812085e-16 , -9.784031714841263e-16 , -2.764384138197423e-15 , 2.172683383366970e-15 , -1.712745009168587e-15 , -7.283964111331473e-01 , 2.335708460131136e+00 , -2.335708460131142e+00 , 7.283964111331505e-01 , -6.052684805571237e-01 , 5.531881513405379e-01 , -4.118744996342894e-01 , 4.001387373211409e-02 , -4.001387373211423e-02 , 4.118744996342875e-01 , -5.531881513405434e-01 , 6.052684805571263e-01 , -8.478819102371171e-01 , -2.986094736670499e+00 , 3.170593840337876e-01 , -7.575703741981508e+00 , -6.081493564170172e-01 , -5.308225262033046e-01 , 1.695763820474237e+00 , 2.104369755301415e-14 , -6.341187680676084e-01 , 1.515140748396290e+01 , 1.025926068545183e-13 , 1.061645052406635e+00 , -7.251256132772479e-01 , 6.368438971833941e-01 , 6.368438971833937e-01 , -7.251256132772499e-01 , 2.738319098001006e-01 , -6.183684874298599e-01 , -1.058587643580508e-01 , 1.757704826419522e-02 , 1.757704826419689e-02 , -1.058587643580511e-01 , -6.183684874298609e-01 , 2.738319098000999e-01 , -5.125097230715698e-01 , -2.289403928497526e+00 , -1.879396150040274e+00 , 1.664514375041700e+01 , -8.012913749741342e+00 , 3.189401662926965e+00 , 2.326853716216187e-15 , 4.578807856995048e+00 , 4.792149885463406e-15 , -6.529688898956887e-15 , 1.602582749948267e+01 , 1.253785791822341e-14 , -6.818507063888184e-01 , 8.775880585926918e-01 , -8.775880585926872e-01 , 6.818507063888136e-01 , -8.738118437886444e-02 , 2.651582443730182e-01 , -1.322561195540328e-01 , -4.442273148970641e-01 , 4.442273148970628e-01 , 1.322561195540340e-01 , -2.651582443730134e-01 , 8.738118437886225e-02 , -7.974127489135094e-01 , -6.236922430914785e+00 , -2.558956055490655e+00 , 1.808814741864171e-02 , 4.570907152891161e+00 , -3.356368804404201e+00 , 1.594825497827028e+00 , -3.276051150650827e-14 , 5.117912110981326e+00 , -3.617629483709374e-02 , -7.161273086846425e-14 , 6.712737608808364e+00 , -1.480572106804040e-01 , -3.573622218689832e-03 , -3.573622218713041e-03 , -1.480572106803935e-01 , 1.669347591321451e-01 , -6.786137731560253e-01 , 1.041482589093550e+00 , -6.931134219926446e-01 , -6.931134219926453e-01 , 1.041482589093538e+00 , -6.786137731560111e-01 , 1.669347591321288e-01 , 2.799036377503165e-01 , 5.219873581184965e-02 , -2.571724174387286e+00 , 3.044926255690781e-01 , 1.826955753414456e-01 , -1.346201771675180e+00 , -2.606315307091710e-14 , -1.043974716236506e-01 , -3.999008456566095e-15 , -2.077296083559973e-13 , -3.653911506827991e-01 , -2.661946412746678e-14 , 2.084600531939316e-16 , -3.323325129600880e-16 , 1.225074295696047e-16 , 1.948378688811714e-17 , -7.588942234553520e-17 , -3.525050735899490e-17 , -2.907890865673171e-18 , -4.183750095923801e-17 , -1.767832940280126e-16 , 1.292155655962904e-16 , -7.433552969063874e-18 , 4.224219968007376e-17 , -3.480081564418491e-16 , -3.432044909484067e-16 , 8.414822413607237e-18 , -2.520032210341789e-15 , -1.816935978954760e-15 , -2.484119813828578e-16 , 3.960541152989759e-16 , -6.724314260737593e-16 , -4.568570845954830e-16 , 3.190426249473536e-15 , 1.976749423744193e-15 , -5.620166950730042e-16 , 3.132702555335193e-01 , -7.892915398688618e-01 , 7.892915398688581e-01 , -3.132702555335162e-01 , -6.052684805571243e-01 , 5.531881513405383e-01 , -4.118744996342886e-01 , 4.001387373211401e-02 , -4.001387373211532e-02 , 4.118744996342892e-01 , -5.531881513405446e-01 , 6.052684805571273e-01 , -8.478819102371205e-01 , -2.986094736670493e+00 , 3.170593840337942e-01 , -7.575703741981503e+00 , -6.081493564170138e-01 , -5.308225262033058e-01 , 1.695763820474235e+00 , 1.271205363195804e-14 , -6.341187680676051e-01 , 1.515140748396292e+01 , 6.172840016915870e-14 , 1.061645052406629e+00 , 3.165410533894190e-01 , -4.048227694832743e-01 , -4.048227694832713e-01 , 3.165410533894174e-01 , 2.738319098001002e-01 , -6.183684874298601e-01 , -1.058587643580512e-01 , 1.757704826419551e-02 , 1.757704826419660e-02 , -1.058587643580504e-01 , -6.183684874298607e-01 , 2.738319098001012e-01 , -5.125097230715683e-01 , -2.289403928497522e+00 , -1.879396150040274e+00 , -1.335485624956891e+01 , -8.012913749741351e+00 , 3.189401662926969e+00 , 2.886579864025407e-15 , 4.578807856995051e+00 , 4.107825191113079e-15 , -3.552713678800501e-15 , 1.602582749948268e+01 , 6.994405055138486e-15 , 7.764826269445151e-01 , -9.974119414073077e-01 , 9.974119414073132e-01 , -7.764826269445196e-01 , -8.738118437886522e-02 , 2.651582443730187e-01 , -1.322561195540333e-01 , -4.442273148970634e-01 , 4.442273148970636e-01 , 1.322561195540339e-01 , -2.651582443730126e-01 , 8.738118437886308e-02 , -7.974127489135125e-01 , 5.763077569079562e+00 , -2.558956055490652e+00 , 1.808814741862841e-02 , -1.342909284710037e+01 , -3.356368804404195e+00 , 1.594825497827029e+00 , -2.740516147348160e-14 , 5.117912110981329e+00 , -3.617629483706652e-02 , -8.235079285157099e-14 , 6.712737608808358e+00 , 3.102761226529303e-01 , 3.809304444797625e-02 , 3.809304444795445e-02 , 3.102761226529401e-01 , 1.669347591321448e-01 , -6.786137731560253e-01 , 1.041482589093550e+00 , -6.931134219926446e-01 , -6.931134219926450e-01 , 1.041482589093539e+00 , -6.786137731560110e-01 , 1.669347591321291e-01 , -1.720096362248743e+00 , 5.219873581185631e-02 , 1.428275825610836e+00 , 3.044926255690787e-01 , 1.826955753414283e-01 , -7.346201771672360e+00 , -2.504680490789113e-14 , -1.043974716236514e-01 , -2.036565360796772e-15 , -2.071953719706698e-13 , -3.653911506828080e-01 , -2.916547212072906e-14 };
    return vdm0_data ;
  }

  static Scalar *get_vdm1_data () {
    static Scalar vdm1_data [] = { -2.077215777546161e-17 , 4.497532419954366e-17 , 1.395477869048875e-17 , -1.801689683070609e-18 , -5.256004151144421e-18 , 5.906332942547531e-17 , -8.340489762820774e-17 , 3.777960716849356e-17 , -1.726869995864454e-17 , -9.373759615886284e-17 , 2.772964838412805e-17 , -7.107270265482998e-17 , 1.390785954329371e-17 , 1.663987709949551e-16 , -1.876584324412310e-16 , 1.886033828351530e-15 , -5.561424964238589e-16 , 5.002649274481598e-16 , 1.999999999999059e+00 , 2.557812658596732e-19 , -6.104686904989796e-16 , -9.424913536820041e-16 , -1.497906028069514e-15 , 5.586346706792694e-17 , -1.109971055945015e-16 , -6.676319220842242e-20 , 1.110650733360118e-16 , 2.185487357496686e-16 , 1.179289117487057e-16 , -1.942520101941059e-16 , -1.393558595732813e-17 , -1.335554342267593e-16 , 4.165670335298066e-17 , 2.150967250503010e-16 , 5.548070901101990e-17 , 3.473167844755854e-17 , -3.539027342080131e-16 , -1.110391218525924e-15 , -1.388801010010850e-16 , -2.221236849852640e-15 , -2.998000479819050e-15 , -9.989647712282516e-16 , -9.158221735257976e-16 , 1.199999999999435e+01 , 2.220640175892915e-16 , -1.054627265231096e-14 , -1.775915642932797e-15 , -8.880470345213833e-16 , -1.803466453167586e-16 , 1.041770541756595e-16 , 2.765700383822703e-17 , 1.250924784256643e-16 , 3.479556077580495e-17 , -2.778711094882555e-16 , 6.979514808290895e-17 , -7.655584987495606e-17 , 3.189034890652354e-16 , -5.616914948927992e-16 , 1.662938153379735e-16 , 1.665788839883597e-16 , -2.364986490201458e-16 , -2.224008905222840e-16 , 1.671506318586295e-16 , 8.880163153269242e-16 , -6.654645329641309e-16 , 3.862219176732729e-16 , -7.218146805827258e-16 , -3.552564169429366e-15 , 3.999999999998120e+00 , -1.998948602842813e-15 , -4.435650230551843e-16 , -6.666296539773839e-16 , 4.158830127064944e-16 , -7.111824150418666e-16 , -3.317285953308852e-16 , 2.863056065014261e-16 , -2.645995401950874e-16 , 1.542582522221642e-16 , -1.414578903232572e-16 , -6.431648223443991e-17 , -1.013945024675496e-16 , 1.342140645583384e-16 , 1.048308304312656e-15 , 1.110189143307266e-16 , -1.582298203052501e-15 , -6.167213007640671e-16 , -9.516271166801031e-16 , -1.085893527874582e-14 , 2.035047477755292e-16 , -4.765593708501090e-15 , -3.495874379907948e-16 , -1.059563169896003e-14 , 1.020735687813634e-15 , 2.999999999998589e+01 , 4.773877690725237e-15 , 9.954534484039879e-16 , 5.105224274196910e-16 , 7.206725721829038e-17 , 7.331290387052256e-16 , 3.128279021458527e-16 , -2.715333519013111e-16 , 2.669314218988784e-16 , 7.802897156259769e-16 , 8.286936251550607e-17 , 3.389934910403669e-16 , 9.173265174810402e-16 , 9.564382638205075e-16 , -1.842322071266521e-16 , -1.916622107333774e-15 , 6.504433764601553e-16 , 5.108963924659038e-16 , -1.323935535854637e-14 , -2.551490241959817e-15 , -2.499588298116810e-15 , 2.856974368452975e-16 , -4.625088730243494e-15 , 3.528449572993454e-15 , 1.999065518155929e-15 , 1.799999999999152e+01 , -6.338603348254000e-15 , -2.236058454654986e-16 , 4.762370748136787e-16 , -4.936709186923035e-17 , -4.868570680272347e-17 , -2.053324331174671e-17 , 1.828486846864306e-16 , -3.282702127468051e-16 , 1.226207312267137e-16 , 2.960532351886489e-16 , -3.736028337487040e-16 , 2.460629652982558e-16 , 6.756919463101483e-17 , -7.716078396748571e-17 , 2.236925922272093e-15 , 9.297163330983249e-17 , 9.970484114436677e-15 , -3.354853135069001e-15 , 8.941845185708687e-16 , 4.159757628142188e-16 , -5.245145646753848e-18 , -1.154708242102887e-15 , -4.559476711116228e-16 , 2.405922336018245e-15 , 5.999999999997175e+00 , -5.242781990719328e-01 , 1.088848607675675e+00 , -1.246859852455416e+00 , 2.041182120611951e-01 , 1.000088408626014e+00 , -5.717316680031027e-01 , 1.710529758989963e-02 , 2.662121068970956e-01 , 2.261982331649828e-01 , 4.289797972242096e-01 , -1.124919819343673e+00 , 1.605356889183172e+00 , 2.379690753799649e+00 , 6.566641342324949e+00 , -2.424686964453469e+00 , 1.172699894120877e+01 , -3.595164190882767e+00 , 5.303901589475014e+00 , 8.478819102371701e-01 , -1.611937742132054e+01 , -3.170593840338053e-01 , 7.575703741981853e+00 , 6.582179025348492e+00 , 5.308225262033721e-01 , -7.815613149872085e-02 , -1.421704324682700e-01 , 7.790143296516572e-01 , -6.469694817785214e-01 , -4.521129381126051e-01 , 9.394753594480695e-01 , -3.979835133185594e-01 , 1.083955290508734e-01 , -9.081848078667877e-02 , 2.921247489605099e-01 , -1.557843846877941e+00 , 7.259448479127107e-01 , 5.721123063229950e-01 , 2.658379480863582e+00 , 4.553018442284852e-01 , 8.962009419958260e+00 , 2.759123964609903e+00 , -1.181932081426722e+00 , -1.656734335717576e+00 , 2.289403928497564e+00 , -2.789999838497272e+00 , -1.278875089499758e+00 , 8.012913749741479e+00 , 5.553265825780439e+00 , -3.045313290132216e-01 , 3.250137933749691e-01 , -5.525742652177004e-01 , 3.773193773755852e-01 , 8.681474322821679e-02 , -1.773112242191530e-01 , -1.303541410203661e-01 , 3.063928787212949e-01 , 7.506201936183592e-01 , 1.901978533677434e-03 , -4.424694685921821e-01 , 1.741959276070944e-01 , 4.806293603804956e-01 , -3.136689992729190e+00 , 3.988246071119543e-01 , -3.597290460374476e+00 , 3.721652855993611e+00 , 3.457559497747877e+00 , 7.974127489135373e-01 , 3.645755454353503e-02 , 2.558956055490666e+00 , -1.808814741837407e-02 , -2.872398559096188e+00 , 3.356368804404207e+00 , 1.236732255891154e-01 , -2.549970823623517e-01 , 2.514234601436560e-01 , -2.717304362695182e-01 , -6.268649435917524e-02 , 2.273488723410376e-01 , -2.622443559331069e-01 , 3.991672917226798e-02 , -7.330301511649129e-01 , 1.303726945026653e+00 , -9.059626454970493e-01 , 2.296212534913095e-01 , 1.879311682401552e-01 , 1.503645839908949e+00 , -9.399940983696823e-01 , 1.714111356444628e-01 , -3.337095824143081e+00 , 7.207464523508623e-01 , -9.595869873000067e-02 , -5.219873581185120e-02 , -6.917359776479013e-01 , -3.832964571977288e-02 , -1.826955753414956e-01 , -2.787694676376957e+00 , -6.265405110670365e-01 , 1.578583079737719e+00 , -1.578583079737713e+00 , 6.265405110670320e-01 , 1.210536961114247e+00 , -1.106376302681076e+00 , 8.237489992685753e-01 , -8.002774746422779e-02 , 8.002774746423080e-02 , -8.237489992685775e-01 , 1.106376302681087e+00 , -1.210536961114252e+00 , 1.695763820474236e+00 , 5.972189473340964e+00 , -6.341187680675893e-01 , 1.515140748396293e+01 , 1.216298712834019e+00 , 1.061645052406613e+00 , -3.391527640948463e+00 , -1.532107773982716e-14 , 1.268237536135209e+00 , -3.030281496792577e+01 , -1.048050535246148e-13 , -2.123290104813254e+00 , -1.146857751384602e-01 , -4.765482466304206e-02 , 7.416367152057900e-01 , -4.279560306719666e-01 , -5.373473058214946e-01 , 8.066242077529951e-01 , -1.152011660816659e-01 , 4.940895496746139e-03 , -3.507297823536856e-02 , 2.966733335526095e-01 , 2.534360564124717e-01 , 6.792117473561129e-02 , 1.535309322850975e-02 , 4.692988560912377e-01 , 1.769440677765691e+00 , 7.659167771496944e+00 , 6.564137107284056e+00 , -2.999184117039032e+00 , 8.478819102370881e-01 , -3.924692448852874e+00 , -3.170593840337975e-01 , 7.575703741981222e+00 , -1.373642357098505e+01 , 5.308225262032894e-01 , -2.275833017110618e-01 , 3.222443867385577e-01 , -7.270671562218207e-01 , 5.441243551004723e-01 , 2.230889769852598e-01 , -4.744138691061658e-01 , 3.968072775206847e-02 , 2.130935638874877e-01 , -1.955165156232920e-01 , -1.455394921101164e-01 , -1.439546183236792e-01 , 5.074293281483394e-02 , 1.794622312249221e-01 , -3.610181057902436e+00 , 2.307019637396807e-01 , -6.117691479598185e+00 , 2.306064322174176e+00 , 3.200817962983940e+00 , -8.714341855213973e-01 , 2.289403928497471e+00 , -2.340800077519588e+00 , -1.119473290372227e+00 , 8.012913749741140e+00 , -3.212234263040984e+00 , 2.654521323248200e-01 , -4.503974076037446e-01 , 5.470145338035526e-01 , -5.110304946196912e-01 , -1.245431262296181e-01 , 3.905709208226288e-01 , -3.113760264278212e-01 , -5.134630884525541e-02 , 3.928810060518073e-01 , -1.791199068737941e-01 , 1.254126764496223e-01 , -3.716194185076310e-02 , 1.045333908299459e-01 , 3.195546804657900e+00 , -1.368061819856577e+00 , 1.840757524398322e+00 , -5.615518353136794e+00 , -2.972627682735487e-01 , 7.974127489135002e-01 , -6.280160402362254e-01 , 2.558956055490662e+00 , -1.808814741863868e-02 , -2.198056140826779e+00 , 3.356368804404161e+00 , -1.036894809883595e-01 , 3.515171693597187e-01 , -3.134241249117546e-01 , 4.139656036412955e-01 , 1.125944410256613e-01 , -4.276929680356558e-01 , 5.648266677314306e-01 , -1.984809393639637e-01 , -4.946324826286804e-01 , 4.766559213621132e-01 , -2.509208051203627e-01 , 5.434031810647562e-02 , -5.942439314865759e-01 , -1.894926488454106e+00 , 1.567123264635663e+00 , 1.462169303112619e-01 , 4.567712070037529e+00 , -2.554311284368131e+00 , -5.316084992756025e-01 , -5.219873581181815e-02 , -1.705970703660496e+00 , 1.205876494640784e-02 , -1.826955753413907e-01 , -2.237579202936099e+00 };
    return vdm1_data ;
  }

  static Scalar *get_dmats0_data() {
    static Scalar dmats0_data[] = { 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 2.000000000000004e+00 , 3.655717703862945e-15 , 1.110223024625157e-15 , -2.615963001773027e-15 , 1.105782132526656e-14 , 8.881784197001252e-16 , 2.363803130039448e-16 , 3.957739485932307e-16 , 1.171902081548777e-15 , 1.776356839400250e-15 , -8.881784197001250e-16 , 3.835605607911849e-15 , 8.814965218667098e-17 , 2.221371235104169e-15 , 8.881784197001252e-16 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , -2.297368644527914e-15 , 6.000000000000004e+00 , 2.786659791809142e-15 , -5.590069302514108e-15 , 2.664535259100375e-15 , -1.598721155460227e-15 , -1.810858561866906e-15 , 3.467930675137577e-15 , -4.440892098500626e-15 , -7.919590908992791e-16 , -8.908441114415425e-15 , 3.588179136531591e-15 , 4.950129812226260e-15 , -3.996802888650564e-15 , -9.251858538543826e-18 , 1.333333333333335e+00 , 2.564615186884110e-15 , 3.333333333333335e+00 , -1.283695372222879e-16 , 1.092459456231154e-14 , 5.329070518200751e-15 , -9.664360594998842e-16 , 2.123815526736650e-15 , 1.998401444325283e-15 , 3.552713678800501e-15 , 7.771561172376129e-16 , 3.049459300862046e-15 , -2.091562519887006e-15 , 3.935740622296183e-15 , 4.440892098500626e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.000000000000003e+00 , -2.845805601751971e-15 , -8.000000000000023e-01 , 1.000000000000001e+01 , -5.928590951498336e-15 , 2.000000000000014e-01 , -3.126398667636448e-15 , -2.164824756845977e-15 , 1.572815951552305e-15 , -1.387778780781446e-15 , 4.632546918087245e-15 , -6.430265971767091e-15 , -1.676128371899369e-15 , -4.157785227221212e-15 , 9.714451465470120e-16 , -1.195868800810527e-15 , 2.399999999999999e+00 , 2.042810365310286e-15 , 1.051820667600539e-16 , 8.400000000000009e+00 , -1.953992523340282e-15 , -1.091205198590657e-15 , 8.558740136363865e-16 , -5.773159728050813e-15 , -1.391479524196865e-15 , -3.332056852656245e-15 , 2.330206734639411e-15 , 5.080426819977399e-15 , 7.105427357600999e-15 , 8.511709855459503e-16 , 9.999999999999993e-01 , -2.681805395038991e-15 , 3.200000000000001e+00 , 1.613292832658427e-15 , 5.062616992290711e-15 , 4.200000000000006e+00 , 7.937907719836413e-17 , -7.668762744169996e-16 , -5.674473236973006e-16 , 1.776356839400250e-15 , 2.220446049250342e-16 , -3.888490726567886e-16 , 2.648216008622659e-15 , 4.316917194084153e-15 , 4.440892098500626e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , -1.199315994749959e-15 , 4.000000000000008e+00 , 1.973194850143741e-15 , -1.361605960047035e-14 , -1.714285714285720e+00 , 1.855658484016334e-15 , 1.400000000000000e+01 , 6.000818036257640e-15 , 2.857142857142886e-01 , 1.718202300015125e-16 , -1.170522012650110e-14 , 5.502799861868944e-15 , 2.331211355642314e-15 , -6.328271240363392e-15 , 2.201942332173227e-15 , 8.000000000000002e-01 , 2.261380802947377e-15 , 7.999999999999980e-01 , 2.857142857142856e+00 , -1.166051382434879e-14 , -1.485714285714291e+00 , 1.262595994833550e-15 , 1.285714285714286e+01 , 5.286776307738841e-15 , 5.142857142857136e-01 , 1.640791412203535e-15 , -5.792280235697147e-15 , 2.085523112229894e-15 , -9.470202400052587e-15 , -3.552713678800501e-15 , 2.877031298653246e-16 , 1.200000000000000e+00 , -3.253633190534154e-16 , 3.668184897932611e-16 , 5.485714285714293e+00 , 2.366361075343894e-15 , -2.176269926653864e-15 , -1.102672060487993e-15 , 1.028571428571428e+01 , 3.605581441877857e-16 , -2.680321242731770e-15 , 3.781066369092739e-15 , 3.371145954981582e-15 , 2.664535259100371e-15 , -4.625929269272011e-17 , 7.999999999999999e-01 , -2.501878774698944e-15 , 2.799999999999999e+00 , -1.020513039153213e-15 , -1.065814103640156e-15 , 4.800000000000000e+00 , 7.600168156621667e-16 , -1.043844610983546e-15 , -1.504968988936321e-15 , 4.799999999999999e+00 , -1.554312234475220e-15 , -8.004352885704412e-16 , 3.148073365774497e-15 , 3.454643978291942e-15 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 };
    return dmats0_data;
  }

  static Scalar *get_dmats1_data() {
    static Scalar dmats1_data[] = { 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 0.000000000000000e+00 , 1.000000000000002e+00 , 1.827858851931473e-15 , 5.551115123125783e-16 , -1.307981500886513e-15 , 5.528910662633279e-15 , 4.440892098500626e-16 , 1.181901565019724e-16 , 1.978869742966153e-16 , 5.859510407743884e-16 , 8.881784197001252e-16 , -4.440892098500625e-16 , 1.917802803955924e-15 , 4.407482609333549e-17 , 1.110685617552084e-15 , 4.440892098500626e-16 , 3.000000000000006e+00 , 4.789687165403695e-15 , 1.776356839400250e-15 , -8.153200337091025e-16 , 2.013944566670034e-14 , 8.881784197001252e-16 , -9.776971600442707e-16 , -4.055397992727949e-16 , 1.757853122323165e-15 , 3.108624468950438e-15 , -5.329070518200750e-15 , 7.085676041417961e-15 , 1.908581317680256e-15 , 1.555700013256003e-15 , 1.776356839400250e-15 , 6.666666666666665e-01 , 3.000000000000002e+00 , -3.333333333333315e-01 , -6.803980604239456e-15 , 4.307665335545607e-15 , -1.443289932012704e-15 , -2.090910100317081e-15 , 2.257209337137497e-15 , -1.418618309243255e-15 , -3.885780586188048e-16 , -8.006934236008214e-15 , 3.556292933164406e-15 , 6.766706536662107e-16 , -5.708396718281013e-16 , -4.718447854656915e-16 , 6.666666666666657e-01 , 5.000000000000004e+00 , 1.666666666666671e+00 , -6.572947561748162e-15 , 6.350475700855894e-15 , 8.881784197001252e-16 , -2.140296567922384e-15 , 5.210102753891483e-15 , -2.109423746787797e-15 , 1.332267629550188e-15 , -9.348087504696455e-15 , 2.442462618240390e-15 , 2.191148497211589e-15 , -1.584843367652410e-15 , 1.776356839400250e-15 , -1.333333333333339e+00 , -2.959361151195280e-15 , 6.666666666666670e+00 , 9.083012120214557e-15 , 1.509903313490210e-15 , 5.329070518200751e-15 , -6.402435633658222e-15 , 3.456083156286838e-15 , 7.648203058528872e-16 , 2.664535259100376e-15 , 4.440892098500635e-15 , -1.572292614099606e-15 , -5.691691973697539e-15 , -1.239749044164735e-16 , 4.440892098500626e-15 , 5.000000000000002e-01 , 2.400000000000001e+00 , -4.000000000000001e-01 , 5.000000000000002e+00 , -6.000000000000026e-01 , 1.000000000000001e-01 , -2.015503247837709e-15 , 1.258148127127420e-15 , -2.405483220021172e-16 , -8.881784197001252e-16 , -2.532452128659149e-15 , -2.097550528330001e-15 , 2.623287389782701e-16 , -4.493627692170321e-15 , 7.910339050454240e-16 , 4.999999999999999e-01 , 1.199999999999999e+00 , 8.000000000000004e-01 , 7.000000000000005e+00 , 4.200000000000004e+00 , -7.000000000000013e-01 , -3.546495775690791e-15 , 2.262888950295884e-15 , -1.591319668629391e-15 , 1.110223024625157e-16 , 1.754390100272977e-15 , -2.607608293153362e-15 , -9.747218464460848e-16 , 9.520162436160713e-16 , 4.440892098500626e-16 , 5.000000000000009e-01 , -3.600000000000004e+00 , 1.599999999999999e+00 , 6.945986995453438e-15 , 8.400000000000009e+00 , 2.100000000000004e+00 , 1.758543624038072e-15 , -3.217539403634722e-15 , -3.614392735724119e-15 , 8.881784197001252e-16 , 8.240919520859557e-15 , -5.642185185204478e-16 , 1.676449616987502e-15 , 9.707975164493139e-15 , 1.776356839400250e-15 , 2.500000000000000e+00 , -6.504056552595708e-15 , -2.000000000000004e+00 , -8.135853102331224e-16 , -6.661338147751002e-16 , 1.050000000000000e+01 , 4.347672614741063e-15 , -6.275844041978315e-15 , -4.403884664346452e-15 , -3.552713678800501e-15 , -6.217248937900881e-15 , -2.227244763479376e-15 , 1.240539307081591e-14 , 6.536438057480606e-15 , 0.000000000000000e+00 , 4.000000000000007e-01 , 2.000000000000001e+00 , -4.000000000000004e-01 , 4.285714285714284e+00 , -8.571428571428605e-01 , 1.714285714285737e-01 , 6.999999999999997e+00 , -7.142857142857127e-01 , 1.428571428571441e-01 , -2.857142857142896e-02 , -2.558755676476370e-15 , 5.051888574510642e-16 , 1.057281834099050e-15 , -4.202194148206218e-15 , 1.710437347313132e-15 , 4.000000000000002e-01 , 1.200000000000003e+00 , 3.999999999999999e-01 , 1.428571428571425e+00 , 2.914285714285708e+00 , -7.428571428571438e-01 , 9.000000000000000e+00 , 6.428571428571431e+00 , -1.285714285714282e+00 , 2.571428571428565e-01 , -2.337841854261606e-15 , -2.214446359167745e-15 , 3.037693553488263e-16 , -2.417510636121280e-15 , -1.110223024625157e-16 , 3.999999999999987e-01 , 6.000000000000013e-01 , 1.000000000000001e+00 , -5.714285714285717e+00 , 2.742857142857146e+00 , 5.714285714285703e-01 , 4.183175938346368e-16 , 1.028571428571428e+01 , 5.142857142857144e+00 , -1.028571428571430e+00 , -2.623342001447694e-15 , 1.534939403414216e-15 , 9.024417016137114e-15 , 2.498001805406322e-17 , -2.886579864025407e-15 , 3.999999999999996e-01 , 4.200000000000004e+00 , 1.400000000000000e+00 , -6.663784658557935e-15 , -4.800000000000003e+00 , 2.400000000000003e+00 , -3.837907241356101e-15 , 1.758141325059389e-15 , 1.200000000000000e+01 , 2.399999999999999e+00 , -9.147052328536044e-15 , 6.065079228220986e-15 , 3.461223077697124e-15 , -7.931618325092893e-15 , 8.881784197001252e-16 , -1.599999999999999e+00 , 2.715816989285446e-15 , 5.600000000000003e+00 , -2.391935855732587e-15 , -7.016609515630994e-15 , -2.400000000000013e+00 , 4.223333243170086e-16 , 4.357074665788342e-15 , -8.141635513917805e-16 , 1.440000000000000e+01 , 4.440892098500570e-16 , 5.627260722491471e-15 , -6.822474683963894e-15 , -5.312417172831383e-15 , -5.773159728050814e-15 };
    return dmats1_data;
  }
#endif


  public:

  /** \brief Constructor.
  */
  Basis_F1_TRI_I4_FEM_FIAT() : numDof_(24), isSet_(false) , vdm0_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TRI_I4_FEM_FIAT::get_vdm0_data(),24,24,15) ) ),vdm1_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TRI_I4_FEM_FIAT::get_vdm1_data(),24,24,15) ) ),dmats0_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TRI_I4_FEM_FIAT::get_dmats0_data(),15,15,15) ) ),dmats1_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F1_TRI_I4_FEM_FIAT::get_dmats1_data(),15,15,15) ) ) { }
  
  /** \brief Initializes arrays needed for the lookup of the local enumeration (DoF Id) of a 
    degree-of-freedom by its local DoF tag and the reverse lookup of the DoF tag by DoF Id.
   */
  void initialize();
  
  
  /** \brief Returns FieldContainer with multi-indexed quantity with the values of an operator 
  applied to a set of FEM basis functions, evaluated at a set of
  points in a <strong>reference</strong> cell. The rank of the return
  FieldContainer argument depends on the number of points, number of
  basis, functions, their rank, and the rank of the operator applied to them; see 
  FieldContainer::resize(int,int,EField,EOperator,int) for summary of
  the admissible index combinations.
  In particular, the admissible range of the <var>operatorType</var> argument depends on the rank of 
  the basis functions and the space dimension.Because FEM
  reconstruction relies on COMPLETE or INCOMPLETE polynomials, i.e.,
  smooth local spaces, the admissible range of <var>operatorType</var>
  always includes VALUE, D0, D1,...,D10. If derivative order exceeds
  polynomial degree, output container is filled with 0. 
 
      \param outputValues   [out]         - FieldContainer with the computed values (see
                                            implementation for index ordering)
      \param inputPoints     [in]         - evaluation points on the reference cell  
      \param operatorType    [in]         - the operator being applied to the basis function
  */    

  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const EOperator                        operatorType) const;
  
  
  /** \brief This method is intended for FVD reconstructions and should not be used here. Its 
    invocation will throw an exception. 
  */  
  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const Cell<Scalar>&                    cell) const;

  
  int getNumLocalDof() const;
  
  
  int getLocalDofEnumeration(const LocalDofTag dofTag);

  
  LocalDofTag getLocalDofTag(int id);

  
  const Teuchos::Array<LocalDofTag> & getAllLocalDofTags();

  
  ECell getCellType() const;

  
  EBasis getBasisType() const;

  
  ECoordinates getCoordinateSystem() const;

  
  int getDegree() const;

};

} // namespace Intrepid

#include "Intrepid_F1_TRI_I4_FEM_FIATDef.hpp"

#endif

