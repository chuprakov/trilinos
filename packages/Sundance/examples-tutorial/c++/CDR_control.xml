<ParameterList name="CDR Boundary Control">


<!-- Name of output file. A .vtu or .pvtu suffix will be appended          -->
<Parameter name="Output Filename"   type="string"   value="cdr-control"/>


<!-- Fractional perturbation of initial parameters away from nominal       -->
<Parameter name="Perturbation Magnitude" type="double" value="0.25"/>


<!-- Model specification -->

<ParameterList name="Model">
  <!-- alpha=0 is a phase transition. With positive alpha, the field damps  -->
  <!-- very quickly with distance from a nonzero fluctuation. When alpha is -->
  <!-- negative, macroscopically large zones of nonzero order parameter can -->
  <!-- exist.                                                               -->
  <Parameter name="Alpha" type="double" value="-1.0"/>
  <!-- beta sets the magnitude of the nonzero constant solutions            -->
  <!-- psi(x)=beta/alpha. Positive and negative beta/alpha are the          -->
  <!-- minimizers of the Landau Hamiltonian reached in the limit            -->
  <!-- as D goes to zero.                                                   -->
  <Parameter name="Beta" type="double" value="1.0"/>
  <!-- D is the strength of the diffusion term                              -->
  <Parameter name="Diffusivity" type="double" value="0.08"/>
  <!-- Scale of advective velocity field                                    -->
  <Parameter name="Peak Velocity" type="double" value="0.1"/>
  <!-- Order of quadrature rule used on boundary surfaces                   -->
  <Parameter name="BC Quadrature Order" type="int" value="4"/>
  <!-- Number of design variables                                           -->
  <Parameter name="Num Controls" type="int" value="6"/>

  <!-- Whether to apply Dirichlet BCs on nodes or edges                    -->
  <Parameter name="Apply BCs at Nodes" type="bool" value="true"/>
  <!-- Whether to approximate Dirichlet BCs by Robin BCs                   -->
  <Parameter name="Use Robin BCs" type="bool" value="false"/>
  <!-- Weighting for Robin BCs                                             -->
  <Parameter name="Robin BC gamma" type="double" value="1.0"/>
</ParameterList>



<!-- specification of linear solver to be used in MOOCHO -->
<ParameterList name="Moocho Linear Solver">
  <ParameterList name="Linear Solver Types">
    <ParameterList name="AztecOO">
      <ParameterList name="Forward Solve">
        <ParameterList name="AztecOO Settings">
          <Parameter name="Aztec Preconditioner" type="string" value="ilu"/>
          <Parameter name="Aztec Solver" type="string" value="GMRES"/>
          <Parameter name="Convergence Test" type="string" value="r0"/>
          <Parameter name="Drop Tolerance" type="double" value="0"/>
          <Parameter name="Fill Factor" type="double" value="1"/>
          <Parameter name="Graph Fill" type="int" value="0"/>
          <Parameter name="Ill-Conditioning Threshold" type="double" value="1e+11"/>
          <Parameter name="Orthogonalization" type="string" value="Classical"/>
          <Parameter name="Output Frequency" type="int" value="0"/>
          <Parameter name="Overlap" type="int" value="0"/>
          <Parameter name="Polynomial Order" type="int" value="3"/>
          <Parameter name="RCM Reordering" type="string" value="Disabled"/>
          <Parameter name="Size of Krylov Subspace" type="int" value="300"/>
          <Parameter name="Steps" type="int" value="3"/>
        </ParameterList>
        <Parameter name="Max Iterations" type="int" value="400"/>
        <Parameter name="Tolerance" type="double" value="1e-06"/>
      </ParameterList>
      <Parameter name="Output Every RHS" type="bool" value="0"/>
    </ParameterList>
  </ParameterList>
</ParameterList>


<!-- Mesh specification -->
  <!-- Notes:                                                                       -->
  <!-- (1) don't change ax, bx, ay, or by just yet. The hardwired cell filters      -->
  <!--     in CubicCDR.cpp depend on these values. If you want to change them,      -->
  <!--     you'll have to modify the predicate definitions in CubicCDR.cpp.         -->
  <!-- (2) The parameters nx and ny are the numbers of elements in x and y          -->
  <!--     *per processor*. Holding them fixed as npx and npx increase will         -->
  <!--     increase the overall problem size.                                       -->
  <!-- (3) npx times npy must equal the number of processors                        -->
<ParameterList name="Mesh">
  <Parameter name="type" type="string" value="Rectangle"/>
  <Parameter name="nx" type="int" value="32"/>
  <Parameter name="npx" type="int" value="1"/>
  <Parameter name="ax" type="double" value="0.0"/>
  <Parameter name="bx" type="double" value="1.0"/>
  <Parameter name="ny" type="int" value="32"/>
  <Parameter name="npy" type="int" value="1"/>
  <Parameter name="ay" type="double" value="0.0"/>
  <Parameter name="by" type="double" value="1.0"/>
</ParameterList>




<!-- specification of how to solve a forward problem for generating test cases -->

<ParameterList name="Forward Problem">

   <!-- design variables for target problem -->
   <Parameter name="Design Parameters" type="string" 
              value="0.0 0.5 0.1 0.75 0.0 0.0"/>   

   <!-- filename for writing target solution -->         
   <Parameter name="Output Filename"   type="string"   value="cdr-target"/>

    <!-- Nonlinear solver specification -->
   <ParameterList name="Nonlinear Solver">

   <!-- Continuation parameters. It is a good idea to do continuation on the      -->
   <!-- nonlinear terms; a cold start from psi=0 when alpha and beta are large    -->
   <!-- will lead to convergence problems                                         -->
   <Parameter  name="Number of Continuation Steps"  type="int" value="10"/>

   <!-- NOX parameters -->
   <ParameterList name="NOX Solver">

      <Parameter name="Nonlinear Solver" type="string" value="Line Search Based"/>
      
      <ParameterList name="Direction">
        <Parameter name="Method" type="string" value="Newton"/>
        <ParameterList name="Newton">
          <Parameter name="Forcing Term Minimum Tolerance" type="double" value="1.0e-10"/>
          <Parameter name="Forcing Term Initial Tolerance" type="double" value="1.0e-8"/>
          <Parameter name="Forcing Term Method" type="string" value="Constant"/>
        </ParameterList>
      </ParameterList>

      <ParameterList name="Line Search">
        <Parameter name="Method" type="string" value="More'-Thuente"/>
      </ParameterList>

      <ParameterList name="Status Test">
        <Parameter name="Max Iterations" type="int" value="25"/>
        <Parameter name="Tolerance" type="double" value="1e-8"/>
      </ParameterList>

      <!-- See the NOX documentation for printing settings.                -->
      <!-- 15=0xF prints pretty much everything.                           -->
      <ParameterList name="Printing">
        <Parameter name="Output Information" type="int" value="0"/>
      </ParameterList>

      <!-- use Aztec for linear solves -->
      <!-- Note: GMRES converges pretty slowly for this problem. BICGSTAB reduces the -->
      <!-- residual more quickly, but the resulting Newton steps are bad; presumably  -->
      <!-- BICGSTAB isn't actually reducing the error despite the residual reduction. -->
      <ParameterList name="Linear Solver">
        <Parameter name="Max Iterations" type="int" value="100"/>
        <Parameter name="Method" type="string" value="GMRES"/>
        <ParameterList name="Preconditioner">
          <Parameter name="Type" type="string" value="ML"/>
          <Parameter name="Problem Type" type="string" value="SA"/>
          <ParameterList name="ML Settings">
            <Parameter name="output" type="int" value="0"/>
            <Parameter name="prec type" type="string" value="MGW"/>
            <Parameter name="max levels" type="int" value="10"/>
            <Parameter name="smoother: type" type="string" value="symmetric Gauss-Seidel"/>
            <Parameter name="aggregation: damping factor" type="double" value="1.33"/>
          </ParameterList>
        </ParameterList> 
        <Parameter name="Tolerance" type="double" value="1.0e-8"/>
        <Parameter name="Type" type="string" value="Aztec"/>
        <Parameter name="Restart Size" type="int" value="200"/>
        <Parameter name="Verbosity" type="int" value="4"/>
      </ParameterList>

   </ParameterList>
  </ParameterList>
</ParameterList>

</ParameterList>
