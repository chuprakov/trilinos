#!/bin/bash

ZDIR=/home/lriesen/projects/Trilinos-zoltan_gid_64/packages/zoltan

PARMETIS_ZOLTAN=$ZDIR/build_parmetis/src/driver/zdrive.exe
SCOTCH_ZOLTAN=$ZDIR/build_scotch_32/src/driver/zdrive.exe
SCOTCH_64_ZOLTAN=$ZDIR/build_scotch/src/driver/zdrive.exe
NO_TPL_ZOLTAN=$ZDIR/build/src/driver/zdrive.exe
BOTH_TPL_ZOLTAN=$ZDIR/build_both/src/driver/zdrive.exe
ZOLTAN_32_NO_TPL=$ZDIR/build_32/src/driver/zdrive.exe
ZOLTAN_32_BOTH=$ZDIR/build_32_both/src/driver/zdrive.exe
ZOLTAN_32_PARMETIS=$ZDIR/build_32_parmetis/src/driver/zdrive.exe
ZOLTAN_32_SCOTCH=$ZDIR/build_32_scotch/src/driver/zdrive.exe


testName=$1
testNum=$2
testDir=$3

echo Running in test directory $3: $1 on $2 procs

echo -n "Go on?"
read  answer 

if [  "$answer" = "no" ] ; then
  exit
fi

mpiexec -np $testNum $BOTH_TPL_ZOLTAN zdrive.inp.$testName

echo -n "Save it?"
read saveIt

if [  "$saveIt" = "no" ] ; then
  exit
fi

declare -i count=0
declare -i done=$testNum
idx=0

while [ $count -lt $done ] ; do
  if [ $done -ge 10 ] ; then
    if [ $count -lt 10 ] ; then
      idx=0$count
    else
      idx=$count
    fi
  else
    idx=$count
  fi
  
  echo "$testDir.out.$testNum.$idx===> answers/$testDir.$testName.$testNum.$idx"
  cp $testDir.out.$testNum.$idx answers/$testDir.$testName.$testNum.$idx
  let count=$count+1
done
