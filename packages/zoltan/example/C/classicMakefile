##
## a basic makefile to build examples
##

## Location of zoltan library, also location of Zoltan_config.h if
## using the autoconf build harness

BLD=../../build64/src
#BLD=../../build/src

#ADDRESS_SPACE_FLAG=-DUSE_32_BIT_ADDRESS_SPACE

##
## Location of zoltan "src" directory (for header files)
##

SRC=../../src

# Location of zoltan header files

ZOLTAN_INCLUDE=-I$(SRC)/include

##
## Headers for zoltan utilities, not often used by applications
## Needed for use of Zoltan_Hash in simpleGRAPH.c
##

ZOLTAN_UTIL_INCLUDE=-I$(SRC)/zz  \
                    -I$(SRC)/par \
                    -I$(SRC)/order \
                    -I$(SRC)/lb \
                    -I$(SRC)/params \
                    -I$(SRC)/Utilities/shared

##
## If Zoltan was built with ParMETIS, provide the information required
## to link with the ParMETIS library.
##

#PAR_LIB_DIR=-L/home/lafisk/system/parmetis/ParMetis-3.1.1
#PAR_LIBS=-lparmetis -lmetis

#MPI_DIR=/home/lriesen/system/mpich2_32

##
## C compiler
##
#CC=$(MPI_DIR)/bin/mpicc

CC=mpicc

##
## C++ compiler
##
#CXX=$(MPI_DIR)/bin/mpicxx

CXX=mpicxx

# MPI include and library options if needed
#MPI_INCLUDE=-I$(MPI_DIR)/src/include
#MPI_LIBS=$(MPI_DIR)//lib/libmpich.a


CFLAGS = -g -Wall $(ADDRESS_SPACE_FLAG)
CXXFLAGS = -g -Wall $(ADDRESS_SPACE_FLAG)


C_EXAMPLES = simpleBLOCK  simpleRCB simpleGRAPH simplePHG migrateGRAPH

all:   $(C_EXAMPLES) $(CPP_EXAMPLES)

%: %.c
	$(CC) $(CFLAGS) $(PAR_LIB_DIR)  \
        -I$(BLD)/include $(MPI_INCLUDE) $(ZOLTAN_INCLUDE) $(ZOLTAN_UTIL_INCLUDE) \
        -o $@ $< $(BLD)/libzoltan.a $(PAR_LIBS) -lm $(MPI_LIBS)

%: %.cpp
	$(CXX) $(CFLAGS) $(CXXFLAGS) $(PAR_LIB_DIR)  \
        -I$(BLD)/include $(MPI_INCLUDE) $(ZOLTAN_INCLUDE) $(ZOLTAN_UTIL_INCLUDE) \
        -o $@ $< $(BLD)/libzoltan.a $(PAR_LIBS) -lm $(MPI_LIBS)

clean:
	@rm -rf  $(C_EXAMPLES) $(CPP_EXAMPLES)
